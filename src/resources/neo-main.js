(()=>{"use strict";var t={622:(t,e,n)=>{n.d(e,{Z:()=>l});var i=n(81),o=n.n(i),a=n(645),r=n.n(a)()(o());r.push([t.id,".neo-input.is-static .ni_block .block-checkbox,.neo-input.is-static .ni_block .block-settings,.neo-input.is-static .ni_block .block-reorder,.neo-input.is-static .ni_buttons{display:none}.neo-input.is-static .ni_block:last-child{margin-bottom:0}.neo-input.is-translatable .field>.heading .locale{display:none}.ni_buttons{position:relative;height:30px}.ni_buttons>.btngroup,.ni_buttons>.menubtn{position:absolute;top:0}body.ltr .ni_buttons>.btngroup,body.ltr .ni_buttons>.menubtn{left:0}body.rtl .ni_buttons>.btngroup,body.rtl .ni_buttons>.menubtn{right:0}.ni_blocks>.ni_buttons{margin-bottom:10px}.ni_spinner{margin-bottom:10px;text-align:center}.ni_block{box-sizing:border-box;width:100%;margin-bottom:10px;border-radius:4px;border:1px solid #e3e5e8;background-color:#f3f7fc;padding:0}.ni_block:focus{outline:0}.ni_block_topbar{position:relative;height:30px;line-height:30px;background-color:#ebf2fa;color:#8f98a3;transition:background-color 0.5s;padding:0 14px}.ni_block_topbar_left,.ni_block_topbar_right{display:flex;position:absolute;top:0;bottom:0}body.ltr .ni_block_topbar_left{left:14px}body.rtl .ni_block_topbar_left{right:14px}.ni_block_topbar_right{min-width:100px}body.ltr .ni_block_topbar_right{right:14px}body.rtl .ni_block_topbar_right{left:14px}.ni_block_topbar_item{cursor:default;padding:0 8px;-webkit-user-select:none;-moz-user-select:none;user-select:none;white-space:nowrap}body.ltr .ni_block_topbar_item:not(:first-child),body.rtl .ni_block_topbar_item:not(:last-child){padding-left:0}.ni_block_topbar_item:first-child{padding-left:0}.ni_block_topbar_item:last-child{padding-right:0}.ni_block_topbar_item.size-full{flex-grow:1}.ni_block_topbar_item.clip-text{overflow:hidden;text-overflow:ellipsis}.ni_block_topbar_item.title .blocktype{padding:8px 0}.ni_block_topbar_item.title .blocktype.has-errors{color:#da5a47}.ni_block_topbar_item.title .preview{pointer-events:none;position:absolute;width:calc(100% - 80px);height:30px;overflow:hidden;color:#b9bfc6;transition:opacity 0.2s}body.ltr .ni_block_topbar_item.title .preview{margin-left:8px}body.rtl .ni_block_topbar_item.title .preview{margin-right:8px}.ni_block_topbar_item.title .preview:empty{display:none}.ni_block_topbar_item.title .preview_section{display:inline-block;padding:0 8px;height:30px;line-height:30px}body.ltr .ni_block_topbar_item.title .preview_section{border-left:1px solid #e3e5e8}body.rtl .ni_block_topbar_item.title .preview_section{border-right:1px solid #e3e5e8}.ni_block_topbar_item.title .preview img,.ni_block_topbar_item.title .preview_color{vertical-align:top;margin-top:15px;transform:translateY(-50%)}.ni_block_topbar_item.title .preview img{max-width:30px;max-height:30px}.ni_block_topbar_item.title .preview_color{display:inline-block;width:16px;height:16px;border-radius:50%}body.ltr .ni_block_topbar_item.title .preview .status{margin-right:6px}body.rtl .ni_block_topbar_item.title .preview .status{margin-left:6px}.ni_block_topbar_item.tabs{position:relative;transition:opacity 0.2s}.ni_block_topbar_item.tabs .tabs_inner{white-space:nowrap}body.ltr .ni_block_topbar_item.tabs .tabs_inner{right:0;direction:ltr}body.rtl .ni_block_topbar_item.tabs .tabs_inner{left:0;direction:rtl}.ni_block_topbar_item.tabs .tabs_btn{position:absolute;top:0;display:inline-flex;cursor:pointer;height:30px;padding:0 9px;border:1px solid #e3e5e8;border-top:0;border-bottom-color:#fbfcfd;margin-bottom:-1px;background-color:#fbfcfd;color:#576575}body.ltr .ni_block_topbar_item.tabs .tabs_btn{right:8px}body.rtl .ni_block_topbar_item.tabs .tabs_btn{left:8px}.ni_block_topbar_item.tabs .tabs_btn.has-errors{color:#da5a47}.ni_block_topbar_item.tabs .tab{display:inline-block;height:30px;padding:0 10px;border-bottom-color:#fafafa;color:rgba(41,50,61,0.5)}.ni_block_topbar_item.tabs .tab:hover{color:#0d78f2}.ni_block_topbar_item.tabs .tab.is-selected{cursor:default;padding:0 9px;border-left:1px solid #e3e5e8;border-right:1px solid #e3e5e8;border-bottom-width:1px;border-bottom-style:solid;margin-bottom:-1px;background-color:#f3f7fc;color:#576575}.ni_block_topbar_item.tabs .tab.is-selected.is-blank{border-bottom-color:#f1f5f8;background-color:transparent;transition:border-bottom-color 0.5s}.ni_block_topbar_item.tabs .tab.has-errors{color:#da5a47}.ni_block_topbar_item.block-settings .settings{padding:0 8px;height:20px}.ni_block_topbar_item.block-settings .settings:not(:hover):not(:active){background-color:transparent}.ni_block_topbar_item.block-settings .settings::before{margin-right:0 !important}.ni_block_topbar_item.block-settings .menu{line-height:20px}.ni_block_topbar_item .invisible{visibility:hidden;pointer-events:none}.ni_block_topbar_item>.checkbox{position:relative;display:block;height:100%;color:#29323d}.ni_block_topbar_item>.checkbox::before{position:absolute;top:50%;margin-top:-8px}.ni_block_topbar_item>.checkbox::after{display:none}.ni_block_topbar_item>.status{margin:10px 5px 0 0}.ni_block_topbar_item>a{color:rgba(41,50,61,0.25)}.ni_block_topbar_item>a:hover{color:#0d78f2}.ni_block_body{padding:0 14px 14px}.ni_block_content:empty{display:none}.ni_block_content_tab{padding:14px 0 0}.ni_block_content_tab.is-blank{padding:0;border-top:0}#content .ni_block_content_tab:not(.is-selected),.lp-editor .ni_block_content_tab:not(.is-selected),.element-editor .ni_block_content_tab:not(.is-selected){display:none}.ni_block_content_tab>.field{margin:15px 0 0 0}.ni_block_content_tab.flex-fields{--row-gap: var(--m) !important}.ni_block_content_tab.flex-fields>.field::before{display:none}.ni_block_children{padding:14px 0 7px;transition:background-color 0.5s}.ni_block_body>.ni_block_children:not(:first-child){margin-top:14px;border-top:1px solid #e3e5e8}.ni_block_collapsed-children{overflow:hidden}.ni_block_collapsed-children_child{height:2px;border-top:1px solid #e3e5e8;background-color:#fbfcfd;margin-top:-3px;transition:margin-top 0.2s}.ni_block.is-level-even{background-color:#fbfcfd}.ni_block.is-level-even>.ni_block_topbar{background-color:#ebf2fa80}.ni_block.is-level-even>.ni_block_topbar>.ni_block_topbar_right>.ni_block_topbar_item.tabs .tab.is-blank{border-bottom-color:white}.ni_block.is-level-even>.ni_block_topbar>.ni_block_topbar_right>.ni_block_topbar_item.tabs .tab.is-selected{background-color:#fbfcfd}.ni_block.is-expanded>.ni_block_topbar .title>.preview{opacity:0}.ni_block.is-collapsed{padding-bottom:0}.ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_left{overflow:hidden}.ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_left::before{content:'';pointer-events:none;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1}body.ltr .ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_left::before{background-image:linear-gradient(-90deg, #f3f7fc 0, rgba(243,247,252,0) 40px, rgba(243,247,252,0) 100%)}body.rtl .ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_left::before{background-image:linear-gradient(90deg, #f3f7fc 0, rgba(243,247,252,0) 40px, rgba(243,247,252,0) 100%)}body.ltr .ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_left{right:80px}body.rtl .ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_left{left:80px}.ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_right{pointer-events:none}.ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_right>.tabs{opacity:0}.ni_block.is-collapsed>.ni_block_topbar .ni_block_topbar_right>:not(.tabs){pointer-events:auto}.ni_block.is-collapsed>.ni_block_collapsed-children .ni_block_collapsed-children_child{margin-top:0}.ni_block.is-disabled .ni_block_topbar_item.title .preview{opacity:0}.ni_block.is-disabled .ni_block_content_tab .field{pointer-events:none;opacity:0.5;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ni_block.is-empty{padding:6px 0}.ni_block.is-empty.is-level-even{background-color:white}.neo_block_tabs-menu a.is-selected{cursor:default;pointer-events:none;opacity:0.25}.neo_block_tabs-menu a.has-errors{color:#da5a47}.ni_block .matrixblock,.neo-matrixblock{border-color:#ccc;background-color:white;box-shadow:0 1px 5px -1px rgba(0,0,0,0.1)}.ni_block .matrixblock>.titlebar,.neo-matrixblock>.titlebar{border-bottom-color:#eee;background-color:#fbfcfd}\n",""]);const l=r},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,o,a){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(r[s]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);i&&r[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),e.push(d))}},e}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var a={},r=[],l=0;l<t.length;l++){var s=t[l],c=i.base?s[0]+i.base:s[0],d=a[c]||0,h="".concat(c," ").concat(d);a[c]=d+1;var u=n(h),p={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var b=o(p,i);i.byIndex=l,e.splice(l,0,{identifier:h,updater:b,references:1})}r.push(h)}return r}function o(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var a=i(t=t||[],o=o||{});return function(t){t=t||[];for(var r=0;r<a.length;r++){var l=n(a[r]);e[l].references--}for(var s=i(t,o),c=0;c<a.length;c++){var d=n(a[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}a=s}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var a=e[i]={id:i,exports:{}};return t[i](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t=jQuery;var e=n.n(t);e().fn.insertAt=function(t,e){return this.each((function(){0===t?e.prepend(this):e.children().eq(t-1).after(this)}))};const i=Garnish;var o=n.n(i);const a=Craft;var r=n.n(a);function l(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}const c={_stack:[[]],enter:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("string"==typeof t&&(t=this.fromFieldName(t)),e){var n=this.getNamespace();n.push.apply(n,l(t)),t=n}this._stack.push(t)},enterByFieldName:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.enter(this.fromFieldName(t),e)},leave:function(){return this._stack.length>1?this._stack.pop():this.getNamespace()},getNamespace:function(){return Array.from(this._stack[this._stack.length-1])},parse:function(t){return"string"==typeof t?t.indexOf("[")>-1?this.fromFieldName(t):t.indexOf("-")>-1?t.split("-"):t.indexOf(".")>-1?t.split("."):t:Array.from(t)},value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=this.getNamespace();return n.push(t),n.join(e)},fieldName:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.toFieldName();return e?e+t.replace(/([^'"[\]]+)([^'"]*)/,"[$1]$2"):t},toString:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-";return this.getNamespace().join(t)},toFieldName:function(){var t=this.getNamespace();switch(t.length){case 0:return"";case 1:return t[0]}return t[0]+"["+t.slice(1).join("][")+"]"},fromFieldName:function(t){return t.match(/[^[\]\s]+/g)||[]}};function d(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function u(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=p(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw a}}}}function p(t,e){if(t){if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var f=o().Drag.extend({$container:null,blocks:null,maxTopBlocks:0,_draggeeBlocks:null,init:function(t,n){void 0===n&&e().isPlainObject(t)&&(n=t,t=null),(n=e().extend({},f.defaults,n)).axis=o().Y_AXIS,this.base(t,n),this.$container=n.container,this.blocks=[],this.maxTopBlocks=n.maxTopBlocks},getHelperTargetX:function(){return this.$draggee.offset().left},getHelperTargetY:function(){var t=this.settings.magnetStrength;if(1!==t){var e=this.$draggee.offset().top;return e+(this.mouseY-this.mouseOffsetY-e)/t}return this.base()},getBlockByElement:function(t){return this.blocks.find((function(e){return e.$container.is(t)}))},getParentBlock:function(t){var e=t.$container.parent().closest(".ni_block");return e.length>0&&this.getBlockByElement(e)},onDragStart:function(){var t=this;this._draggeeBlocks=[],this.$draggee.each((function(){t._draggeeBlocks.push(t.getBlockByElement(this))})),this.base(),this._calculateMidpoints()},onDrag:function(){var t=this._getClosestMidpoint();t&&this._moveDraggeeToBlock(t.block,t.type,t.direction),this.base()},onDragStop:function(){var t=this;this.$draggee.each((function(){var n=e()(this),i=t.getBlockByElement(n);if(n.parent().is(t.$container))i.setLevel(1);else{var o=t.getParentBlock(i);i.setLevel(o.getLevel()+1)}n.find(".ni_block").each((function(){var n=e()(this),i=t.getBlockByElement(n),o=t.getParentBlock(i);i.setLevel(o.getLevel()+1)}))})),this.returnHelpersToDraggees(),this.base()},addBlock:function(t){this.blocks.push(t),this.addItems(t.$container)},removeBlock:function(t){this.blocks=this.blocks.filter((function(e){return e!==t})),this.removeItems(t.$container)},_getClosestMidpoint:function(){var t,e=Number.MAX_VALUE,n=Number.MIN_VALUE,i=null,o=u(this._currentMidpoints);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a.direction===f.DIRECTION_UP)this.mouseY-this.mouseOffsetY<a.position&&a.position<e&&(e=a.position,i=a);else this.mouseY-this.mouseOffsetY+this._draggeeBlockHeight>a.position&&a.position>n&&(n=a.position,i=a)}}catch(t){o.e(t)}finally{o.f()}return i},_calculateMidpoints:function(){this._draggeeBlockY=this.$draggee.offset().top,this._draggeeBlockHeight=this.$draggee.height()+10,this._currentMidpoints=[];var t,e=u(this.blocks);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(0===n.$container.closest(this.$draggee).length)for(var i=this._getBlockMidpoints(n),o=0,a=Object.keys(i);o<a.length;o++){var r=a[o],l=i[r],s=this._draggeeBlockY>l?f.DIRECTION_UP:f.DIRECTION_DOWN;this._currentMidpoints.push({block:n,position:l,type:r,direction:s})}}}catch(t){e.e(t)}finally{e.f()}var c=this.$container.offset().top+this.$container.height()+5;this._currentMidpoints.push({block:null,position:c,type:f.TYPE_END,direction:f.DIRECTION_DOWN})},_getBlockMidpoints:function(t){var e={};if(!(t.$container.parent().closest(".ni_block.is-collapsed").length>0)){var n=t.$container.offset().top,i=t.isExpanded(),o=t.$container.height(),a=t.$topbarContainer.height(),r=i?t.$childrenContainer.height():0,l=i&&t.$contentContainer.length>0?t.$childrenContainer.length>0?t.$childrenContainer.offset().top-t.$contentContainer.offset().top:t.$contentContainer.height():0,s=this.getParentBlock(t);if(s&&!this._validateDraggeeChildren(s)||(e[f.TYPE_CONTENT]=n+(a+l)/2),r>0&&t.isExpanded()&&this._validateDraggeeChildren(t)){var c=t.getButtons().$container.height();e[f.TYPE_CHILDREN]=n+o-1-(14+c+10)/2}}return e},_moveDraggeeToBlock:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.TYPE_CONTENT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.DIRECTION_DOWN,i=t?this.getParentBlock(t):null,o=this._validateDraggeeChildren(i);switch(e){case f.TYPE_CHILDREN:0===this.$draggee.closest(t.$container).length?t.$blocksContainer.append(this.$draggee):o&&t.$container.after(this.$draggee);break;case f.TYPE_END:o&&this.$container.append(this.$draggee);break;default:n===f.DIRECTION_UP?o&&t.$container.before(this.$draggee):t.getBlockType().isParent()&&t.isExpanded()&&this._validateDraggeeChildren(t)?t.$blocksContainer.prepend(this.$draggee):o&&t.$container.after(this.$draggee)}this._updateHelperAppearance(),this._calculateMidpoints()},_validateDraggeeChildren:function(t){var e=this,n=t?t.getField():this._draggeeBlocks[0].getField(),i=n.getMaxLevels();if(i>0){var o=t?t.getLevel():-1,a=this._draggeeBlocks[0].getLevel();if(this._draggeeBlocks.filter((function t(e){var r=e.getChildren(n.getBlocks(),!0);return function(t){return t.getLevel()-a+o+1>=i}(e)||r.some(t)})).length>0)return!1}if(!t){var r,l=this,s=this.$container.children(".ni_block:not(.is-disabled)"),c=s.length,p=u(this._draggeeBlocks);try{for(p.s();!(r=p.n()).done;){if(!r.value.getBlockType().getTopLevel())return!1}}catch(t){p.e(t)}finally{p.f()}return s.each((function(){l._draggeeBlocks.includes(l.getBlockByElement(this))&&c--})),!(this.maxTopBlocks>0&&c>=this.maxTopBlocks)}var b=t.getBlockType(),f=b.getMaxChildBlocks(),g=t.$childrenContainer.children(".ni_blocks").children(".ni_block"),_=g.length,v=[],k=this;if(g.each((function(){var t=k.getBlockByElement(this);k._draggeeBlocks.includes(t)?_--:v.push(t)})),f>0&&_>=f)return!1;var m,y=[],B=u(this._draggeeBlocks);try{var x=function(){var t=m.value;if(!b.isValidChildBlock(t))return{v:!1};if(y.includes(t))return"continue";var n=t.getBlockType(),i=n.getMaxSiblingBlocks();if(0===i)return"continue";var o=e._draggeeBlocks.filter((function(t){return t.getBlockType().getHandle()===n.getHandle()}));if(v.filter((function(t){return t.getBlockType().getHandle()===n.getHandle()})).length+o.length>i)return{v:!1};y.push.apply(y,d(o))};for(B.s();!(m=B.n()).done;){var C=x();if("continue"!==C&&"object"===h(C))return C.v}}catch(t){B.e(t)}finally{B.f()}return!0},_updateHelperAppearance:function(){var t,e=this,n=u(this.helpers);try{var i=function(){var n=t.value,i=n.data("neo-b-id"),o=e.blocks.find((function(t){return t.$container.data("neo-b-id")===i}));n.css({width:o.$container.width()+1,height:o.$container.height()})};for(n.s();!(t=n.n()).done;)i()}catch(t){n.e(t)}finally{n.f()}}},{TYPE_CONTENT:"content",TYPE_CHILDREN:"children",TYPE_END:"end",DIRECTION_UP:"up",DIRECTION_DOWN:"down",defaults:{container:null,magnetStrength:1}});const g=f;var _={name:"",bodyHtml:"",footHtml:"",errors:[]};const v=o().Base.extend({init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign({},_,t),this._name=t.name,this._bodyHtml=t.bodyHtml||"",this._footHtml=t.footHtml||"",this._errors=t.errors},getErrors:function(){return Array.from(this._errors)},getName:function(){return this._name},getBodyHtml:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._getHtml(this._bodyHtml,t)},getFootHtml:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._getHtml(this._footHtml,t)},isBlank:function(){return!this._bodyHtml.trim()},_getHtml:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==e?t.replace(/__NEOBLOCK__/g,e):t}});var k={id:-1,fieldLayoutId:-1,fieldTypes:{},sortOrder:0,name:"",handle:"",maxBlocks:0,maxSiblingBlocks:0,maxChildBlocks:0,childBlocks:!1,topLevel:!0,tabs:[],hasChildBlocksUiElement:!1};const m=o().Base.extend({init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign({},k,t),this._id=0|t.id,this._fieldLayoutId=0|t.fieldLayoutId,this._fieldTypes=t.fieldTypes,this._sortOrder=0|t.sortOrder,this._name=t.name,this._handle=t.handle,this._maxBlocks=0|t.maxBlocks,this._maxSiblingBlocks=0|t.maxSiblingBlocks,this._maxChildBlocks=0|t.maxChildBlocks,this._childBlocks=t.childBlocks,this._topLevel=t.topLevel,this._tabs=t.tabs.map((function(t){return t instanceof v?t:new v(t)})),this._hasChildBlocksUiElement=t.hasChildBlocksUiElement},getType:function(){return"blockType"},getId:function(){return this._id},getFieldLayoutId:function(){return this._fieldLayoutId},getFieldTypes:function(){return this._fieldTypes},getSortOrder:function(){return this._sortOrder},getName:function(){return this._name},getHandle:function(){return this._handle},getMaxBlocks:function(){return this._maxBlocks},getMaxSiblingBlocks:function(){return this._maxSiblingBlocks},getMaxChildBlocks:function(){return this._maxChildBlocks},getChildBlocks:function(){return this._childBlocks},getTopLevel:function(){return this._topLevel},getTabs:function(){return Array.from(this._tabs)},getFieldType:function(t){return this._fieldTypes[t]},getChildBlockItems:function(t){var e=this,n=t.filter((function(t){return"group"===t.getType()||e.hasChildBlock(t.getHandle())}));return n.filter((function(t,e){if("group"===t.getType()){var i=n[e+1];return i&&"group"!==i.getType()}return!0}))},isParent:function(){var t=this.getChildBlocks();return!0===t||"*"===t||Array.isArray(t)&&t.length>0},hasChildBlock:function(t){var e=this.getChildBlocks();return!0===e||"*"===e||Array.isArray(e)&&e.includes(t)},isValidChildBlock:function(t){return this.hasChildBlock(t.getBlockType().getHandle())},hasChildBlocksUiElement:function(){return this._hasChildBlocksUiElement}});var y={id:-1,sortOrder:0,name:""};const B=o().Base.extend({init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign({},y,t),this._id=0|t.id,this._sortOrder=0|t.sortOrder,this._name=t.name},getType:function(){return"group"},getId:function(){return this._id},getSortOrder:function(){return this._sortOrder},getName:function(){return this._name},isBlank:function(){return!this._name}});function x(t){r().CpFieldInspectPlugin&&r().CpFieldInspectPlugin.addFieldLinks()}function C(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw a}}}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var $={namespace:[],blockType:null,id:null,level:1,buttons:null,enabled:!0,collapsed:!1,modified:!0,showButtons:!0},T={},E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function I(){var t=this.href||this.src;if(t){var e=t.indexOf("?");t=e<0?t:t.substr(0,e);var n=!Object.prototype.hasOwnProperty.call(T,t);return T[t]=1,n}return!0}function S(t){return t?t.replace(/[&<>"'/]/g,(function(t){return E[t]})):""}function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40;return(t=t||"").length>e?t.slice(0,e-3)+"...":t}const N=o().Base.extend({_templateNs:[],_field:null,_blockType:null,_initialised:!1,_expanded:!0,_enabled:!0,_modified:!0,_initialState:null,_forceModified:!1,init:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n=Object.assign({},$,n),this._templateNs=c.parse(n.namespace),this._field=n.field,this._blockType=n.blockType,this._id=n.id,this._buttons=n.buttons,this._modified=n.modified,this._showButtons=n.showButtons,this._renderOldChildBlocksContainer=!n.blockType.hasChildBlocksUiElement(),this.$container=i?this._generateElement():e()("[data-neo-b-id=".concat(this._id,"]"));var o=this.$container.find("[data-neo-b]");this.$bodyContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.body"]')),this.$contentContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.content"]')),this.$childrenContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.children"]')),this.$childrenWarningsContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.childrenWarnings"]')),this.$collapsedChildrenContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.collapsedChildren"]')),this.$blocksContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.blocks"]')),this.$buttonsContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.buttons"]')),this.$topbarContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.topbar"]')),this.$topbarLeftContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.topbarLeft"]')),this.$topbarRightContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.topbarRight"]')),this.$tabsContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.tabs"]')),this.$tabContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.tab"]')),this.$menuContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.menu"]')),this.$previewContainer=o.filter('[data-neo-b="'.concat(this._id,'.container.preview"]')),this.$tabButton=o.filter('[data-neo-b="'.concat(this._id,'.button.tab"]')),this.$settingsButton=o.filter('[data-neo-b="'.concat(this._id,'.button.actions"]')),this.$togglerButton=o.filter('[data-neo-b="'.concat(this._id,'.button.toggler"]')),this.$tabsButton=o.filter('[data-neo-b="'.concat(this._id,'.button.tabs"]')),this.$enabledInput=o.filter('[data-neo-b="'.concat(this._id,'.input.enabled"]')),this.$levelInput=o.filter('[data-neo-b="'.concat(this._id,'.input.level"]')),this.$status=o.filter('[data-neo-b="'.concat(this._id,'.status"]')),this.$sortOrder=o.filter('[data-neo-b="'.concat(this._id,'.sortOrder"]')),this._buttons&&(this._buttons.on("newBlock",(function(e){return t.trigger("newBlock",Object.assign(e,{level:t.getLevel()+1}))})),this.$buttonsContainer.append(this._buttons.$container));var a=!1;if(this._blockType){var r,l=C(this._blockType.getTabs());try{for(l.s();!(r=l.n()).done;){var s=r.value,d='[data-neo-b-info="'.concat(s.getName(),'"]');this.$tabContainer.filter(d).find("ul.errors").length>0&&(a=!0,this.$tabButton.filter(d).addClass("error"))}}catch(t){l.e(t)}finally{l.f()}}this.setLevel(n.level),this.toggleEnabled(n.enabled),this.toggleExpansion(!!a||!n.collapsed,!1,!1),this.toggleShowButtons(this._showButtons),this.addListener(this.$topbarContainer,"dblclick","@doubleClickTitle"),this.addListener(this.$tabButton,"click","@setTab")},_generateElement:function(){c.enter(this._templateNs);var t=c.toFieldName();c.leave();var n=this._blockType,i=n.getTabs(),a=i.length>0,l=n.isParent(),s="".concat(n.getName()," ").concat(r().t("neo","Actions")),d="neoblock-action-menu-".concat(this._id),h=[];if(h.push('\n      <div class="ni_block ni_block--'.concat(n.getHandle()," is-").concat(this._collapsed?"collapsed":"expanded"," ").concat(a||l?"":"is-empty"," ").concat(l?"is-parent":"",'" data-neo-b-id="').concat(this._id,'">\n        <input type="hidden" name="').concat(t,'[type]" value="').concat(n.getHandle(),'">\n        <input type="hidden" name="').concat(t,'[enabled]" value="').concat(this._enabled?"1":"0",'" data-neo-b="').concat(this._id,'.input.enabled">\n        <input type="hidden" name="').concat(t,'[level]" value="').concat(this._level,'" data-neo-b="').concat(this._id,'.input.level">\n        <input type="hidden" name="').concat(this._templateNs[0],"[").concat(this._templateNs[1],'][sortOrder][]" value="').concat(this._id,'" data-neo-b="').concat(this._id,'.input.sortOrder">\n\n        <div class="ni_block_topbar" data-neo-b="').concat(this._id,'.container.topbar">\n          <div class="ni_block_topbar_left" data-neo-b="').concat(this._id,'.container.topbarLeft">\n            <div class="ni_block_topbar_item" data-neo-b="').concat(this._id,'.select">\n              <div class="checkbox block-checkbox" title="').concat(r().t("neo","Select"),' aria-label="').concat(r().t("neo","Select"),'"></div>\n            </div>\n            <div class="ni_block_topbar_item title clip-text">\n              <span class="blocktype" data-neo-b="').concat(this._id,'.select">').concat(n.getName(),'</span><span class="preview" data-neo-b="').concat(this._id,'.container.preview">&nbsp;</span>\n            </div>\n          </div>\n          <div class="ni_block_topbar_right" data-neo-b="').concat(this._id,'.container.topbarRight">\n            <div class="ni_block_topbar_item size-full tabs">')),(a||l)&&h.push('\n              <div class="tabs_trigger" data-neo-b="'.concat(this._id,'.button.toggler"></div>')),i.length>1){h.push('\n              <div class="tabs_inner" data-neo-b="'.concat(this._id,'.container.tabs">'));for(var u=0;u<i.length;u++){var p=i[u].getName();h.push('\n                <a class="tab '.concat(u?"":"is-selected",'" data-neo-b="').concat(this._id,'.button.tab" data-neo-b-info="').concat(p,'">').concat(p,"</a>"))}h.push('\n              </div>\n              <div class="tabs_btn menubtn" data-neo-b="'.concat(this._id,'.button.tabs">\n                ').concat(i[0].getName(),'\n              </div>\n              <div class="neo_block_tabs-menu menu">\n                <ul>'));for(var b=0;b<i.length;b++){var f=i[b].getName();h.push("\n                  <li>\n                    <a".concat(b?"":' class="is-selected"',' data-neo-b="').concat(this._id,'.button.tab" data-neo-b-info="').concat(f,'">').concat(f,"</a>\n                  </li>"))}h.push("\n                </ul>\n              </div>")}if(h.push('\n            </div>\n            <div class="ni_block_topbar_item hidden" data-neo-b="'.concat(this._id,'.status">\n              <div class="status off" title="').concat(r().t("neo","Disabled"),'"></div>\n            </div>\n            <div class="ni_block_topbar_item block-settings">\n              <div data-wrapper>\n                <button class="btn settings icon menubtn" type="button" role="button" title="').concat(r().t("neo","Actions"),'" aria-controls="').concat(d,'" aria-label="').concat(s,'" data-disclosure-trigger data-neo-b="').concat(this._id,'.button.actions"></button>\n                <div id="').concat(d,'" class="menu menu--disclosure" data-neo-b="').concat(this._id,'.container.menu">\n                  <ul class="padded">')),(a||l)&&h.push('\n                    <li><a data-icon="collapse" data-action="collapse" href="#" type="button" role="button" aria-label="'.concat(r().t("neo","Collapse"),'">').concat(r().t("neo","Collapse"),'</a></li>\n                    <li class="hidden"><a data-icon="expand" data-action="expand" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Expand"),'">').concat(r().t("neo","Expand"),"</a></li>")),h.push('\n                    <li><a data-icon="disabled" data-action="disable" href="#" type="button" role="button" aria-label="'.concat(r().t("neo","Disable"),'">').concat(r().t("neo","Disable"),'</a></li>\n                    <li class="hidden"><a data-icon="enabled" data-action="enable" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Enable"),'">').concat(r().t("neo","Enable"),'</a></li>\n                    <li class="hidden"><a data-icon="uarr" data-action="moveUp" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Move up"),'">').concat(r().t("neo","Move up"),'</a></li>\n                    <li class="hidden"><a data-icon="darr" data-action="moveDown" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Move down"),'">').concat(r().t("neo","Move down"),'</a></li>\n                  </ul>\n                  <hr>\n                  <ul class="padded">\n                    <li><a data-icon="plus" data-action="add" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Add block above"),'">').concat(r().t("neo","Add block above"),'</a></li>\n                    <li><a data-icon="field" data-action="copy" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Copy"),'">').concat(r().t("neo","Copy"),'</a></li>\n                    <li><a data-icon="brush" data-action="paste" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Paste"),'">').concat(r().t("neo","Paste"),'</a></li>\n                    <li><a data-icon="share" data-action="duplicate" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Clone"),'">').concat(r().t("neo","Clone"),'</a></li>\n                  </ul>\n                  <hr>\n                  <ul class="padded">\n                    <li><a class="error" data-icon="remove" data-action="delete" href="#" type="button" role="button" aria-label="').concat(r().t("neo","Delete"),'">').concat(r().t("neo","Delete"),'</a></li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n            <div class="ni_block_topbar_item block-reorder">\n              <a class="move icon" title="').concat(r().t("neo","Reorder"),'" aria-label="').concat(r().t("neo","Reorder"),'" role="button" data-neo-b="').concat(this._id,'.button.move"></a>\n            </div>\n          </div>\n        </div>')),a||l){if(h.push('\n        <div class="ni_block_body" data-neo-b="'.concat(this._id,'.container.body">')),a){h.push('\n          <div class="ni_block_content" data-neo-b="'.concat(this._id,'.container.content">'));for(var g=0;g<i.length;g++){var _=i[g].getName();h.push('\n            <div class="ni_block_content_tab flex-fields'.concat(g?"":" is-selected",'" data-neo-b="').concat(this._id,'.container.tab" data-neo-b-info="').concat(_,'">\n              ').concat(i[g].getBodyHtml(this._id),"\n            </div>")),o().$bod.append(i[g].getFootHtml(this._id))}h.push("\n          </div>")}l&&this._renderOldChildBlocksContainer&&h.push('\n          <div class="ni_block_children" data-neo-b="'.concat(this._id,'.container.children">\n            <div class="ni_blocks" data-neo-b="').concat(this._id,'.container.blocks">\n            </div>\n            <div data-neo-b="').concat(this._id,'.container.buttons" class="hidden"></div>\n            <div data-neo-b="').concat(this._id,'.container.childrenWarnings" class="hidden">\n              <p class="first warning with-icon">').concat(r().t("neo","This Neo field's maximum number of levels has been reached, so no child blocks can be added here."),"</p>\n            </div>\n          </div>")),h.push("\n        </div>")}return l&&h.push('\n        <div class="ni_block_collapsed-children" data-neo-b="'.concat(this._id,'.container.collapsedChildren"></div>')),h.push('\n      <div data-neo="container.buttons"></div>'),e()(h.join(""))},initUi:function(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this._initialised){var i=this._blockType.getTabs(),a=i.map((function(e){return e.getFootHtml(t._id)}));if(this.$foot=e()(a.join("")).filter(I),o().$bod.append(this.$foot),n&&r().initUiElements(this.$contentContainer),this.$tabsButton.menubtn(),this._settingsMenu=new(o().DisclosureMenu)(this.$settingsButton),this._settingsMenu.on("show",(function(){return t.$container.addClass("active")})),this._settingsMenu.on("hide",(function(){return t.$container.removeClass("active")})),this.addListener(this.$menuContainer.find("[data-action]"),"click",this._handleActionClick),this.addListener(this.$menuContainer.find("[data-action]"),"keydown",this._handleActionKeydown),this._initialised=!0,this._buttons&&this._buttons.initUi(),o().requestAnimationFrame((function(){return t.updateResponsiveness()})),this.$container.on("mousedown",".matrixblock",(function(t){e()(this).addClass("neo-matrixblock")})),!this._modified&&!this.isNew()){this._initialState={enabled:this._enabled,level:this._level,content:o().getPostData(this.$contentContainer)};var l=function(){return t._detectChange()},s=new window.MutationObserver((function(){return setTimeout(l,200)}));if(s.observe(this.$container[0],{attributes:!0,childList:!0,characterData:!0,subtree:!0}),this.$contentContainer.on("propertychange change click","input, textarea, select, div.redactor-in",l),this.$contentContainer.on("paste input keyup",'input:not([type="hidden"]), textarea, div.redactor-in',l),this._detectChangeObserver=s,this.$contentContainer.length>0&&this.$contentContainer.html().match(/\[blocks\]\[new/)){this._forceModified=!0,this.setModified(!0);var c=this._templateNs[0]+"["+this._templateNs[1]+"]";r().modifiedDeltaNames.includes(c)||r().modifiedDeltaNames.push(c)}}x(this.$contentContainer),this.trigger("initUi")}},destroy:function(){this._initialised&&(this.$foot.remove(),clearInterval(this._detectChangeInterval),this._detectChangeObserver&&this._detectChangeObserver.disconnect(),this.trigger("destroy"))},getBlockType:function(){return this._blockType},getId:function(){return this._id},getLevel:function(){return this._level},setLevel:function(t){this._level=0|t,this.$levelInput.val("0".concat(this._level)),this.$container.toggleClass("is-level-odd",!!(this._level%2)),this.$container.toggleClass("is-level-even",!(this._level%2))},setModified:function(t){this._modified=t},getButtons:function(){return this._buttons},getLocale:function(){if(!this._locale){var t=this.$container.closest("form").find('input[name="siteId"]');this._locale=t.val()}return this._locale},getContent:function(){for(var t=o().getPostData(this.$contentContainer),n={},i=function(t,i){for(var o=n,a=0;a<t.length-1;a++){var r=t[a];e().isPlainObject(o[r])||e().isArray(o[r])||(o[r]={}),o=o[r]}o[t[t.length-1]]=i},a=0,r=Object.keys(t);a<r.length;a++){var l=r[a],s=c.parse(l).slice(this._templateNs.length+1);if(s.length)i(s,t[l])}return n},getParent:function(t){var e=this.getLevel(),n=t.indexOf(this),i=null;if(n>=0&&e>1)for(;null===i&&n>0;){var o=t[--n];o.getLevel()===e-1&&(i=o)}return i},getChildren:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getLevel(),i=t.indexOf(this),o=[];if(i>=0)for(var a=t[++i];a&&a.getLevel()>n;){var r=a.getLevel();(e?r>n:r===n+1)&&o.push(a),a=t[++i]}return o},getSiblings:function(t){return 1===this._level?t.filter((function(t){return 1===t.getLevel()})):this.getParent(t).getChildren(t)},getField:function(){return this._field},updatePreview:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t="boolean"==typeof t&&t;var n=this.$childrenContainer.find(".field"),i=this.$contentContainer.find(".field").add(n),a=[];i.each((function(){var n=e()(this),i=n.children(".input"),l=n.data("type"),s=n.children(".heading").children("label").text();if(null!==l){var c=!1;switch(l){case"craft\\fields\\Assets":var d=[],h=i.find(".element");h.each((function(){var n=e()(this),i=n.find(".elementthumb"),o=i.children("img").prop("srcset");if(o||(o=i.data("srcset")),d.push('<img sizes="30px" srcset="'.concat(o,'">')),!t&&1===h.length){var a=n.find(".title").text();d.push(S(O(a)))}})),c=d.join(" ");break;case"craft\\fields\\Categories":case"craft\\fields\\Entries":case"craft\\fields\\Tags":case"craft\\fields\\Users":var u=[];i.find(".element").each((function(){var t=e()(this).find(".title, .label").eq(0).text();u.push(S(O(t)))})),c=u.join(", ");break;case"craft\\fields\\Checkboxes":var p=[];i.find('input[type="checkbox"]').each((function(){if(this.checked){var t=e()(this).prop("id"),n=i.find('label[for="'.concat(t,'"]')).text();p.push(S(O(n)))}})),c=p.join(", ");break;case"craft\\fields\\Color":var b=i.find('input[type="color"]').val(),f=i.find('input[type="text"]').val(),g=i.find("div.colorhex").text(),_=null;_=b&&f?"background-color: ".concat(b):!b&&f?"background-color: ".concat(f):g?"background-color: ".concat(g):"background-image: repeating-linear-gradient(-45deg, transparent, transparent 2px, #777 2px, #777 3px)",c='<div class="preview_color" style="'.concat(_,'"></div>');break;case"craft\\fields\\Date":var v=S(i.find(".datewrapper input").val()),k=S(i.find(".timewrapper input").val());c=v&&k?v+" "+k:v||k;break;case"craft\\fields\\Dropdown":c=S(O(i.find("select").children(":selected").text()));break;case"craft\\fields\\Email":c=S(O(i.children('input[type="email"]').val()));break;case"craft\\fields\\Lightswitch":var m=!!i.find("input").val();c='<span class="status'.concat(m?" live":"",'"></span>')+S(O(s));break;case"craft\\fields\\MultiSelect":case"ttempleton\\categorygroupsfield\\fields\\CategoryGroupsField":var y=[];i.find("select").children(":selected").each((function(){y.push(e()(this).text())})),c=S(O(y.join(", ")));break;case"craft\\fields\\Number":case"craft\\fields\\PlainText":c=S(O(i.children('input[type="text"]').val()));break;case"craft\\fields\\RadioButtons":c=S(O(i.find('input[type="radio"]:checked').closest("label").text()));break;case"craft\\redactor\\Field":c=S(O(r().getText(i.find("textarea").val())));break;case"craft\\ckeditor\\Field":c=S(O(r().getText(i.find('[role="textbox"]').html())));break;case"craft\\fields\\Url":c=S(O(i.children('input[type="url"]').val()));break;case"craft\\fields\\Matrix":case"verbb\\supertable\\fields\\SuperTableField":var B=n.find(".field").find('input[type!="hidden"], select, textarea, .label'),x=[];B.each((function(){var t=e()(this),n=null;t.is("input, textarea")?n=r().getText(o().getInputPostVal(t)):t.is("select")?n=t.find("option:selected").text():t.hasClass("label")&&(n=t.text()),n&&x.push(O(n))})),c=S(x.join(", "));break;case"typedlinkfield\\fields\\LinkField":case"fruitstudios\\linkit\\fields\\LinkitField":var C=[],w=i.find("select").children(":selected").first(),$=i.find('.linkfield--typeOption:not(.hidden), [class^="linkit--"]:not(.hidden)'),T=$.find('input[type!="hidden"]').val(),E=$.find(".element"),I=i.find('.field[id*="customText"] input, .linkit--customText input').val();if(C.push(O(w.text())),T&&C.push(O(T)),E.length>0){var N=E.find(".title, .label").eq(0).text();C.push(O(N))}I&&C.push(O(I)),c=S(C.join(", "));break;case"luwes\\codemirror\\fields\\CodeMirrorField":var L=[];n.find(".CodeMirror-line > span").each((function(){L.push(e()(this).text())})),c=S(L.join(" "));break;case"rias\\positionfieldtype\\fields\\Position":c=S(i.find(".btn.active").prop("title"));break;case"wrav\\oembed\\fields\\OembedField":c=S(O(i.children("input").val()))}c&&a.length<10&&a.push('<span class="preview_section">',c,"</span>")}})),this.$previewContainer.html(a.join(""))},isNew:function(){return/^new/.test(this.getId())},isSelected:function(){return this.$container.hasClass("is-selected")},collapse:function(t,e){this.toggleExpansion(!1,t,e)},expand:function(t,e){this.toggleExpansion(!0,t,e)},toggleExpansion:function(t,e,n){var i=this;if(e="boolean"!=typeof e||e,n="boolean"!=typeof n||n,(t="boolean"==typeof t?t:!this._expanded)!==this._expanded){this._expanded=t;var o=this.$menuContainer.find('[data-action="expand"]').parent(),a=this.$menuContainer.find('[data-action="collapse"]').parent();this.$container.toggleClass("is-expanded",this._expanded).toggleClass("is-collapsed",!this._expanded),o.toggleClass("hidden",this._expanded),a.toggleClass("hidden",!this._expanded),this._expanded||this.updatePreview();var r={opacity:1,height:(0|this.$contentContainer.outerHeight())+(0|this.$childrenContainer.outerHeight())},l={opacity:0,height:0},s={opacity:"",height:""};n?this.$bodyContainer.css(this._expanded?l:r).velocity(this._expanded?r:l,"fast",(function(t){i._expanded&&i.$bodyContainer.css(s)})):this.$bodyContainer.css(this._expanded?s:l),e&&this.saveExpansion(),this.trigger("toggleExpansion",{expanded:this._expanded})}},isExpanded:function(){return this._expanded},saveExpansion:function(){if(!this.isNew()){var t=this.getId(),n=e()("#main-form").data("elementEditor"),i=n.duplicatedElements[t],o=n.settings.isProvisionalDraft&&void 0!==i?i:t,a={expanded:this.isExpanded()?1:0,blockId:o,locale:this.getLocale()};r().queueActionRequest((function(){return r().postActionRequest("neo/input/save-expansion",a)}))}},disable:function(){this.toggleEnabled(!1)},enable:function(){this.toggleEnabled(!0)},toggleEnabled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._enabled;if(t!==this._enabled){this._enabled=t;var e=this.$menuContainer.find('[data-action="enable"]').parent(),n=this.$menuContainer.find('[data-action="disable"]').parent();this.$container.toggleClass("is-enabled",this._enabled).toggleClass("is-disabled",!this._enabled),this.$status.toggleClass("hidden",this._enabled),e.toggleClass("hidden",this._enabled),n.toggleClass("hidden",!this._enabled),this.$enabledInput.val(this._enabled?1:0),this.trigger("toggleEnabled",{enabled:this._enabled})}},isEnabled:function(){return this._enabled},toggleShowButtons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._showButtons;this.$buttonsContainer.toggleClass("hidden",!t),this.$childrenWarningsContainer.toggleClass("hidden",t)},selectTab:function(t){var n=e()().add(this.$tabButton).add(this.$tabContainer);n.removeClass("is-selected");var i=n.filter('[data-neo-b-info="'.concat(t,'"]')).addClass("is-selected");this.$tabsButton.text(t),r().ElementThumbLoader.retryAll(),this.trigger("selectTab",{tabName:t,$tabButton:i.filter('[data-neo-b="button.tab"]'),$tabContainer:i.filter('[data-neo-b="container.tab"]')})},updateResponsiveness:function(){if(void 0===this._topbarLeftWidth){var t=this._expanded?0:this.$previewContainer.width();this._topbarLeftWidth=this.$topbarLeftContainer.width()-t}this._topbarRightWidth=this._topbarRightWidth||this.$topbarRightContainer.width();var e=this.$topbarContainer.width()<this._topbarLeftWidth+this._topbarRightWidth;this.$tabsContainer.toggleClass("invisible",e),this.$tabsButton.toggleClass("invisible",!e)},updateMenuStates:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;o="boolean"!=typeof o||o;var l=this.getBlockType(),s=n.filter((function(t){return t.getBlockType().getHandle()===l.getHandle()})),c=l.getMaxBlocks(),d=this.getSiblings(n),h=n.filter((function(t){return 0===t.getLevel()})).length,u=i>0&&n.length>=i,p=r>0&&h>=r,b=u||p||!o,f=c>0&&s.length>=c,g=b||f,_=JSON.parse(window.localStorage.getItem("neo:copy")||"{}"),v=b||!_.blocks||!_.field||_.field!==t,k=this.getParent(n);if(!v&&k){var m=k.getBlockType().getMaxChildBlocks();if(m>0){var y=k.getChildren(n).length,B=_.blocks.length;v=v||y+B>m}}if(!v||!g){var x=this.getBlockType().getMaxSiblingBlocks();if(x>0){var w=function(t){return Object.prototype.hasOwnProperty.call(t,"type")?t.type===e.getBlockType().getId():"function"==typeof t.getBlockType&&t.getBlockType().getHandle()===e.getBlockType().getHandle()},$=d.filter(w,this).length,T=_.blocks?_.blocks.filter(w,this).length:0;v=v||$+T>x,g=g||$>=x}}if(!v){var E,I=n.reduce((function(t,e){var n=e.getBlockType(),i=n.getId(),o=t[i]||{blockType:n,count:0};return o.count++,t[i]=o,t})),S=C(_.blocks);try{var O=function(){var t=E.value,e=I[t.type];if(e){var n=e.blockType,i=e.count,o=n.getMaxBlocks();v=v||o>0&&i>=o}if(1===t.level){var r=a.find((function(e){return e.getId()===t.type}));v=v||!r}};for(S.s();!(E=S.n()).done;)O()}catch(t){S.e(t)}finally{S.f()}}var N=d.indexOf(this),L=N<=0,M=[-1,d.length-1].includes(N);this.$menuContainer.find('[data-action="moveUp"]').parent().toggleClass("hidden",L),this.$menuContainer.find('[data-action="moveDown"]').parent().toggleClass("hidden",M),this.$menuContainer.find('[data-action="add"]').toggleClass("disabled",b),this.$menuContainer.find('[data-action="duplicate"]').toggleClass("disabled",g),this.$menuContainer.find('[data-action="paste"]').toggleClass("disabled",v)},_handleActionClick:function(t){t.preventDefault(),this["@settingSelect"](t)},_handleActionKeydown:function(t){t.keyCode===o().SPACE_KEY&&(t.preventDefault(),this["@settingSelect"](t))},_detectChange:function(){if(window.draftEditor&&window.draftEditor.enableAutosave&&window.draftEditor.settings.draftId&&(this.setModified(!0),this._forceModified=!0),!this._forceModified){var t=this._initialState,e=o().getPostData(this.$contentContainer),n=!r().compare(e,t.content,!1)||t.enabled!==this._enabled||t.level!==this._level;n!==this._modified&&this.setModified(n)}},"@settingSelect":function(t){this._settingsMenu.hide();var n=e()(t.target);if(!n.hasClass("disabled"))switch(n.attr("data-action")){case"collapse":this.collapse();break;case"expand":this.expand();break;case"disable":this.disable(),this.collapse();break;case"enable":this.enable(),this.expand();break;case"moveUp":this.trigger("moveUpBlock",{block:this});break;case"moveDown":this.trigger("moveDownBlock",{block:this});break;case"delete":this.trigger("removeBlock",{block:this});break;case"add":this.trigger("addBlockAbove",{block:this});break;case"copy":this.trigger("copyBlock",{block:this});break;case"paste":this.trigger("pasteBlock",{block:this});break;case"duplicate":this.trigger("duplicateBlock",{block:this})}},"@doubleClickTitle":function(t){t.preventDefault();var n=e()(t.target).parent(),i=n.closest(this.$topbarLeftContainer).length>0,o=n.closest(this.$topbarRightContainer).length>0;i||o||(window.draftEditor&&window.draftEditor.pause(),this.toggleExpansion(),window.draftEditor&&window.draftEditor.resume())},"@setTab":function(t){t.preventDefault();var n=e()(t.currentTarget).attr("data-neo-b-info");this.selectTab(n)}},{_totalNewBlocks:0,getNewId:function(){return"new".concat(this._totalNewBlocks++)}});function L(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||M(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var H={blockTypes:[],groups:[],items:null,maxBlocks:0,maxTopBlocks:0,blocks:null};const D=o().Base.extend({_blockTypes:[],_groups:[],_maxBlocks:0,_maxTopBlocks:0,init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},H,t)).items?(this._items=Array.from(t.items),this._blockTypes=this._items.filter((function(t){return"blockType"===t.getType()})),this._groups=this._items.filter((function(t){return"group"===t.getType()}))):(this._blockTypes=Array.from(t.blockTypes),this._groups=Array.from(t.groups),this._items=[].concat(L(this._blockTypes),L(this._groups)).sort((function(t,e){return t.getSortOrder()-e.getSortOrder()}))),this._maxBlocks=0|t.maxBlocks,this._maxTopBlocks=0|t.maxTopBlocks,this.$container=this._generateButtons();var e=this.$container.find("[data-neo-bn]");this.$buttonsContainer=e.filter('[data-neo-bn="container.buttons"]'),this.$menuContainer=e.filter('[data-neo-bn="container.menu"]'),this.$blockButtons=e.filter('[data-neo-bn="button.addBlock"]'),this.$groupButtons=e.filter('[data-neo-bn="button.group"]'),t.blocks&&this.updateButtonStates(t.blocks),this.addListener(this.$blockButtons,"activate","@newBlock")},_generateButtons:function(){var t=[],n=null,i=!0;t.push('\n      <div class="ni_buttons">\n        <div class="btngroup" data-neo-bn="container.buttons">');for(var o=0;o<this._items.length;o++){var a=this._items[o],l=a.getType();"blockType"===l?null!==n?t.push('\n            <li>\n              <a data-neo-bn="button.addBlock" data-neo-bn-info="'.concat(a.getHandle(),'">').concat(a.getName(),"</a>\n            </li>")):(t.push('\n          <div class="btn dashed'.concat(i?" add icon":"",'" data-neo-bn="button.addBlock" data-neo-bn-info="').concat(a.getHandle(),'">\n            ').concat(a.getName(),"\n          </div>")),i=!1):"group"===l&&(null!==n&&t.push("\n          </ul>\n        </div>"),null!==(n=a.isBlank()||o+2>=this._items.length||"group"===this._items[o+2].getType()?null:a)&&(t.push('\n        <div class="btn dashed'.concat(i?" add icon":"",' menubtn" data-neo-bn="button.group">\n          ').concat(a.getName(),'\n        </div>\n        <div class="menu">\n          <ul>')),i=!1))}null!==n&&t.push("\n            </ul>\n          </div>"),t.push('\n        </div>\n        <div class="btn dashed add icon menubtn hidden" data-neo-bn="container.menu">\n          '.concat(r().t("neo","Add a block"),"\n        </div>")),n=null;var s=!1;t.push('\n        <div class="menu">\n          <ul>');var c,d=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=M(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw a}}}}(this._items);try{for(d.s();!(c=d.n()).done;){var h=c.value,u=h.getType();"blockType"===u?(null===n||s||(s=!0,t.push("\n              <h6>".concat(n.getName(),'</h6>\n              <ul class="padded">'))),t.push('\n            <li>\n              <a data-neo-bn="button.addBlock" data-neo-bn-info="'.concat(h.getHandle(),'">\n                ').concat(h.getName(),"\n              </a>\n            </li>"))):"group"===u&&((null===n||s)&&t.push("\n              </ul>"),s=!1,null===(n=h.isBlank()?null:h)&&t.push("\n              <ul>"))}}catch(t){d.e(t)}finally{d.f()}return t.push("\n          </ul>\n        </div>\n      </div>"),e()(t.join(""))},initUi:function(){e()(".menubtn",this.$container).menubtn(),this.updateResponsiveness()},getBlockTypes:function(){return Array.from(this._blockTypes)},getGroups:function(){return Array.from(this._groups)},getMaxBlocks:function(){return this._maxBlocks},updateButtonStates:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n="boolean"!=typeof n||n;var o=this,a=t.filter((function(t){return 1===t.getLevel()})).length,r=this._maxBlocks>0&&t.length>=this._maxBlocks,l=this._maxTopBlocks>0&&a>=this._maxTopBlocks,s=r||l||!n;this.$blockButtons.each((function(){var n=e()(this),a=s;if(!a){var r=function(t){return t.getBlockType().getHandle()===l.getHandle()},l=o.getBlockTypeByButton(n),c=t.filter(r),d=l.getMaxBlocks(),h=l.getMaxSiblingBlocks(),u=null!==i?i.getChildren(t).filter(r):t.filter((function(t){return 1===t.getLevel()&&t.getBlockType().getHandle()===l.getHandle()}));a=a||d>0&&c.length>=d||h>0&&u.length>=h}n.toggleClass("disabled",a)})),this.$groupButtons.each((function(){var t=e()(this),n=t.data("menubtn"),i=s;if(!i&&n){var o=n.menu.$options;i=o.length===o.filter(".disabled").length}t.toggleClass("disabled",i)}))},updateResponsiveness:function(){this._buttonsContainerWidth||(this._buttonsContainerWidth=this.$buttonsContainer.width());var t=this.$container.width()<this._buttonsContainerWidth;this.$buttonsContainer.toggleClass("hidden",t),this.$menuContainer.toggleClass("hidden",!t)},getBlockTypeByButton:function(t){var e=t.attr("data-neo-bn-info");return this._blockTypes.find((function(t){return t.getHandle()===e}))},"@newBlock":function(t){var n=e()(t.currentTarget).attr("data-neo-bn-info"),i=this._blockTypes.find((function(t){return t.getHandle()===n}));this.trigger("newBlock",{blockType:i})}});var P=n(379),j=n.n(P),F=n(795),U=n.n(F),R=n(569),Y=n.n(R),W=n(565),q=n.n(W),z=n(216),G=n.n(z),V=n(589),Z=n.n(V),J=n(622),K={};K.styleTagTransform=Z(),K.setAttributes=q(),K.insert=Y().bind(null,"head"),K.domAPI=U(),K.insertStyleElement=G();j()(J.Z,K);J.Z&&J.Z.locals&&J.Z.locals;function X(t){return function(t){if(Array.isArray(t))return et(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=tt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw a}}}}function tt(t,e){if(t){if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var nt={name:null,namespace:[],blockTypes:[],groups:[],blocks:[],inputId:null,maxBlocks:0,maxTopBlocks:0,maxLevels:0};const it=o().Base.extend({_templateNs:[],_name:null,_locale:null,init:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n=Object.assign({},nt,n),this._templateNs=c.parse(n.namespace),this._blockTypes=[],this._groups=n.groups.map((function(t){return new B(t)})),this._blocks=[],this._name=n.name,this._maxBlocks=n.maxBlocks,this._maxTopBlocks=n.maxTopBlocks,this._maxLevels=n.maxLevels,this._ownerId=null;var i=e()('[name="setId"], [name="entryId"], [name="categoryId"]');i.length&&(this._ownerId=i.val()),this.$container=e()("#"+n.inputId);var a={};this._groups.forEach((function(t){a[t.getId()]=!0}));var r,l={},s=Q(n.blockTypes);try{for(s.s();!(r=s.n()).done;){var d=r.value;if(null===d.groupId||void 0!==a[d.groupId]){var h=new m(d);this._blockTypes.push(h),l[h.getHandle()]=h}}}catch(t){s.e(t)}finally{s.f()}var u=this.$container.closest("form");this._locale=u.find('input[name="siteId"]').val();var p=this.$container.find("[data-neo]");this.$blocksContainer=p.filter('[data-neo="container.blocks"]'),this.$buttonsContainer=p.filter('[data-neo="container.buttons"]'),this._buttons=new D({blockTypes:this.getBlockTypes(!0),groups:this.getGroups(),maxBlocks:this.getMaxBlocks(),maxTopBlocks:this.getMaxTopBlocks()}),this.$buttonsContainer.append(this._buttons.$container),this._buttons.on("newBlock",(function(e){return t["@newBlock"](e)})),this._buttons.initUi(),this._blockSort=new g({container:this.$blocksContainer,handle:'[data-neo-b$=".button.move"]',maxTopBlocks:this.getMaxTopBlocks(),filter:function(){return t._blockSort.$targetItem.hasClass("is-selected")?t._blockSelect.getSelectedItems():t._blockSort.$targetItem},collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,helperOpacity:.9,onDragStop:function(){t._updateBlockOrder(),t._updateButtons()}}),this._blockSelect=new(o().Select)(this.$blocksContainer,null,{multi:!0,vertical:!0,handle:'[data-neo-b$=".select"]',checkboxMode:!0,selectedClass:"is-selected sel"}),this.$blocksContainer.find(".ni_block").each((function(n,i){var o=e()(i),a={};a.id=o.attr("data-neo-b-id"),a.sortOrder=n,a.collapsed=o.hasClass("is-collapsed"),a.enabled=!!o.find('[data-neo-b="'.concat(a.id,'.input.enabled"]')).val(),a.level=parseInt(o.find('[data-neo-b="'.concat(a.id,'.input.level"]')).val()),a.field=t,a.namespace=[].concat(X(t._templateNs),[a.id]);var r=o.find('[data-neo-b="'.concat(a.id,'.input.type"]')).val(),s=l[r];a.blockType=new m({id:s.getId(),fieldLayoutId:s.getFieldLayoutId(),fieldTypes:s.getFieldTypes(),name:s.getName(),handle:s.getHandle(),maxBlocks:s.getMaxBlocks(),maxSiblingBlocks:s.getMaxSiblingBlocks(),maxChildBlocks:s.getMaxChildBlocks(),childBlocks:s.getChildBlocks(),topLevel:s.getTopLevel(),hasChildBlocksUiElement:s.hasChildBlocksUiElement()}),a.buttons=new D({items:s.getChildBlockItems(t.getItems()),maxBlocks:t.getMaxBlocks()}),a.showButtons=!t.atMaxLevels(a.level);var c=new N(a);c.initUi(!1),t._setBlockEvents(c),t._blocks.push(c),t._blockSort.addBlock(c),t._blockSelect.addItems(c.$container)})),this._updateBlockOrder(),this._updateBlockChildren(),this._updateButtons(),this.addListener(this.$container,"resize",(function(){return t.updateResponsiveness()}));var b="function"==typeof u.data("serializer")?u.data("serializer")():u.serialize();u.data("initialSerializedValue",b),this._setMatrixClassErrors(),this._setBlockTypeClassErrors(),this._blocks.filter((function(t){return!t.isExpanded()})).forEach((function(t){return t.updatePreview()})),this.trigger("afterInit")},updateResponsiveness:function(){var t,e=Q(this._blocks);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.updateResponsiveness();var i=n.getButtons();i&&i.updateResponsiveness()}}catch(t){e.e(t)}finally{e.f()}this._buttons.updateResponsiveness(),this._tempButtons&&this._tempButtons.updateResponsiveness()},addBlock:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=this._blocks.length;i="boolean"!=typeof i||i;var r=(e=e>=0?Math.max(0,Math.min(e,a)):a)>0&&this._blocks[e-1],l=e<a&&this._blocks[e];if(r){var s=l?l.getLevel():1,c=r.getLevel()+(r.getBlockType().isParent()?1:0);n=Math.max(s,Math.min(n,c));var d=this._findPrevBlockOnLevel(e,n);d?d.$container.after(t.$container):r.$blocksContainer.prepend(t.$container)}else this.$blocksContainer.prepend(t.$container);t.setLevel(n),this._blocks.push(t),this._blockSort.addBlock(t),this._blockSelect.addItems(t.$container),t.initUi(),this._setBlockEvents(t),this._destroyTempButtons(),this._updateBlockOrder(),this._updateBlockChildren(),this._updateButtons(),i&&t.$container.css({opacity:0,marginBottom:-t.$container.outerHeight()}).velocity({opacity:1,marginBottom:10},"fast",(function(e){return o().requestAnimationFrame((function(){return o().scrollContainerToElement(t.$container)}))})),this.trigger("addBlock",{block:t,index:e})},removeBlock:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;window.draftEditor&&window.draftEditor.pause(),n="boolean"!=typeof n||n,i="boolean"==typeof i&&i;var o,a=this._findChildBlocks(this._blocks.indexOf(t)),r=Q(a);try{for(r.s();!(o=r.n()).done;){var l=o.value;this.removeBlock(l,!0,!0)}}catch(t){r.e(t)}finally{r.f()}t.off(".input"),this._blocks=this._blocks.filter((function(e){return e!==t})),this._blockSort.removeItems(t.$container),this._blockSelect.removeItems(t.$container),this._destroyTempButtons(),this._updateButtons();var s=function(){t.$container.remove(),e._updateBlockChildren(),window.draftEditor&&window.draftEditor.resume()};n?t.$container.css({opacity:1,marginBottom:10}).velocity({opacity:0,marginBottom:i?10:-t.$container.outerHeight()},"fast",(function(t){return s()})):s(),t.destroy(),this.trigger("removeBlock",{block:t})},_setBlockEvents:function(t){var e=this;t.on("removeBlock.input",(function(n){e.getSelectedBlocks().length>1?window.confirm(r().t("neo","Are you sure you want to delete the selected blocks?"))&&e._blockBatch(t,(function(t){return e.removeBlock(t)})):e.removeBlock(t)})),t.on("toggleEnabled.input",(function(n){return e._blockBatch(t,(function(t){return t.toggleEnabled(n.enabled)}))})),t.on("toggleExpansion.input",(function(n){return e._blockBatch(t,(function(t){return t.toggleExpansion(n.expanded)}))})),t.on("moveUpBlock.input",(function(n){return e._moveBlock(t,"up")})),t.on("moveDownBlock.input",(function(n){return e._moveBlock(t,"down")})),t.on("newBlock.input",(function(n){return e["@newBlock"](Object.assign(n,{index:e._getNextBlockIndex(t)}))})),t.on("addBlockAbove.input",(function(t){return e["@addBlockAbove"](t)})),t.on("copyBlock.input",(function(t){return e["@copyBlock"](t)})),t.on("pasteBlock.input",(function(t){return e["@pasteBlock"](t)})),t.on("duplicateBlock.input",(function(t){return e["@duplicateBlock"](t)}))},_moveBlock:function(t,e){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(["up","down"].includes(e)){window.draftEditor&&window.draftEditor.pause();var a=t.getSiblings(this.getBlocks()),r=a.indexOf(t),l=r>0&&"up"===e,s=r<a.length-1&&"down"===e;if(-1!==r&&l!==s){var c="boolean"!=typeof i||i,d=t.$container,h=function(){d.detach(),l?a[r-1].$container.before(d):a[r+1].$container.after(d)},u=function(){n._updateBlockOrder(),n._updateButtons(),window.draftEditor&&window.draftEditor.resume()};c?d.css({opacity:1,marginBottom:10}).velocity({opacity:0,marginBottom:-d.outerHeight()},"fast",(function(t){h(),d.css({opacity:0,marginBottom:-d.outerHeight()}).velocity({opacity:1,marginBottom:10},"fast",(function(t){u(),o().requestAnimationFrame((function(){return o().scrollContainerToElement(d)}))}))})):(h(),u())}}},getBlockByElement:function(t){return this._blocks.find((function(e){return e.$container.is(t)}))},getBlocks:function(){return Array.from(this._blocks)},getBlockTypeById:function(t){return this._blockTypes.find((function(e){return e.getId()===t}))},getBlockTypeByHandle:function(t){return this._blockTypes.find((function(e){return e.getHandle()===t}))},getBlockTypes:function(t){return(t="boolean"==typeof t&&t)?this._blockTypes.filter((function(t){return t.getTopLevel()})):Array.from(this._blockTypes)},getGroups:function(){return Array.from(this._groups)},getItems:function(){return[].concat(X(this.getBlockTypes()),X(this.getGroups())).sort((function(t,e){return t.getSortOrder()-e.getSortOrder()}))},getMaxBlocks:function(){return this._maxBlocks},getMaxTopBlocks:function(){return this._maxTopBlocks},getMaxLevels:function(){return this._maxLevels},atMaxLevels:function(t){return this._maxLevels>0&&t+1>this._maxLevels},getSelectedBlocks:function(){var t=this._blockSelect.getSelectedItems();return this._blocks.filter((function(e){return e.$container.closest(t).length>0}))},_setMatrixClassErrors:function(){var t=e()(".ni_block_body .matrix-field .input.errors");t.length&&t.each((function(){var t=e()(this),n=t.closest(".ni_block_content_tab").data("neo-b-info"),i=t.closest(".ni_block").find('.tabs .tab[data-neo-b-info="'+n+'"]');i.length&&i.addClass("has-errors")}))},_setBlockTypeClassErrors:function(){var t=e()(".ni_block .tab.has-errors");t.length&&t.each((function(){t.parents(".ni_block.is-collapsed").each((function(){e()(this).find("> .ni_block_topbar .title .blocktype").addClass("has-errors")}))}))},_updateBlockOrder:function(){var t=this,e=[];this.$blocksContainer.find(".ni_block").each((function(n,i){var o=t.getBlockByElement(i);e.push(o)})),this._blocks=e},_updateBlockChildren:function(){var t,e=Q(this._blocks);try{for(e.s();!(t=e.n()).done;){for(var n=t.value,i=n.$blocksContainer.children(".ni_block"),o=Math.min(i.length,8),a=[],r=0;r<o;r++)a.push('<div class="ni_block_collapsed-children_child"></div>');n.$collapsedChildrenContainer.html(a.join(""))}}catch(t){e.e(t)}finally{e.f()}},_checkMaxChildren:function(t){if(!t)return!0;var e=t.getBlockType().getMaxChildBlocks();return!(e>0)||this._findChildBlocks(t).length<e},_updateButtons:function(){var t=this,e=this.getBlocks();this._buttons.updateButtonStates(e),this._tempButtons&&this._tempButtons.updateButtonStates(e,this._checkMaxChildren(this._tempButtonsBlock));var n,i=Q(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this._findParentBlock(o),r=a?a.getBlockType():null,l=o.getButtons(),s=o.getLevel(),c=r?r.getChildBlocks():this.getBlockTypes(!0);!0===c||"*"===c?c=this.getBlockTypes(!1):Array.isArray(c)&&(c=c.map((function(e){return"string"==typeof e?t.getBlockTypeByHandle(e):e}))),o.updateMenuStates(this._name,e,this.getMaxBlocks(),this._checkMaxChildren(a),c,1===s?this.getMaxTopBlocks():0),l&&l.updateButtonStates(e,this._checkMaxChildren(o),o),o.toggleShowButtons(!this.atMaxLevels(s))}}catch(t){i.e(t)}finally{i.f()}},_blockBatch:function(t,e){var n,i=Q(t.isSelected()?this.getSelectedBlocks():[t]);try{for(i.s();!(n=i.n()).done;){e(n.value)}}catch(t){i.e(t)}finally{i.f()}},_destroyTempButtons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t="boolean"!=typeof t||t,this._tempButtons){var e=this._tempButtons;e.off("newBlock"),t?e.$container.css({opacity:1,marginBottom:10}).velocity({opacity:0,marginBottom:-e.$container.outerHeight()},"fast",(function(t){return e.$container.remove()})):e.$container.remove(),this._tempButtons=null,this._tempButtonsBlock=null}},_findPrevBlockOnLevel:function(t,e){t instanceof N&&(t=this._blocks.indexOf(t));for(var n=this._blocks[--t],i=Number.MAX_VALUE;n;){var o=n.getLevel();if(o<i){if(o===e)return n;i=o}n=this._blocks[--t]}return!1},_findChildBlocks:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t instanceof N&&(t=this._blocks.indexOf(t)),e="boolean"==typeof e&&e;var n=this._blocks[t];return n?n.getChildren(this._blocks,e):[]},_findParentBlock:function(t){t instanceof N&&(t=this._blocks.indexOf(t));var e=this._blocks,n=e[t];if(n){var i=n.getLevel();if(i>1){for(var o=t,a=n;a&&a.getLevel()>=i;)a=e[--o];return a}}return null},_getNextBlockIndex:function(t){t instanceof N&&(t=this._blocks.indexOf(t));var e=this._findChildBlocks(t,!0),n=e[e.length-1];return(n?this._blocks.indexOf(n):t)+1},_duplicate:function(t,n){var i=this;window.draftEditor&&window.draftEditor.pause();var a=e()('<div class="ni_spinner"><div class="spinner"></div></div>');n.$container.after(a);var l=!1,s=function(){};a.css({opacity:0,marginBottom:-a.outerHeight()}).velocity({opacity:1,marginBottom:10},"fast",(function(){l=!0,s()})),r().postActionRequest("neo/input/render-blocks",t,(function(t){if(t.success&&t.blocks.length>0){var e,r=[],c=Q(t.blocks);try{for(c.s();!(e=c.n()).done;){var d=e.value,h=N.getNewId(),u=i.getBlockTypeById(d.type),p=new m({id:u.getId(),fieldLayoutId:u.getFieldLayoutId(),fieldTypes:u.getFieldTypes(),name:u.getName(),handle:u.getHandle(),maxBlocks:u.getMaxBlocks(),maxSiblingBlocks:u.getMaxSiblingBlocks(),maxChildBlocks:u.getMaxChildBlocks(),childBlocks:u.getChildBlocks(),topLevel:u.getTopLevel(),tabs:d.tabs}),b=new D({items:p.getChildBlockItems(i.getItems()),maxBlocks:i.getMaxBlocks()}),f=new N({namespace:[].concat(X(i._templateNs),[h]),field:i,blockType:p,id:h,level:0|d.level,buttons:b,enabled:!!d.enabled,collapsed:!!d.collapsed,showButtons:!i.atMaxLevels(0|d.level)},!0);r.push(f)}}catch(t){c.e(t)}finally{c.f()}s=function(){var t,e=i._getNextBlockIndex(n),l=Q(r);try{for(l.s();!(t=l.n()).done;){var s=t.value;i.addBlock(s,e++,s.getLevel(),!1)}}catch(t){l.e(t)}finally{l.f()}var c=r[0];c.$container.css({opacity:0,marginBottom:a.outerHeight()-c.$container.outerHeight()+10}).velocity({opacity:1,marginBottom:10},"fast",(function(t){return o().requestAnimationFrame((function(){return o().scrollContainerToElement(c.$container)}))})),a.remove(),window.draftEditor&&window.draftEditor.resume()},l&&s()}}))},"@newBlock":function(t){var e=N.getNewId(),n=new N({namespace:[].concat(X(this._templateNs),[e]),field:this,blockType:t.blockType,id:e,buttons:new D({items:t.blockType.getChildBlockItems(this.getItems()),maxBlocks:this.getMaxBlocks()}),showButtons:!this.atMaxLevels(t.level)},!0);this.addBlock(n,t.index,t.level)},"@addBlockAbove":function(t){var e=this;this._destroyTempButtons();var n=t.block,i=this._blocks.indexOf(n),a=this._findParentBlock(i),r=this.getBlocks(),l=new D({blockTypes:a?[]:this.getBlockTypes(!0),blocks:r,groups:a?[]:this.getGroups(),items:a?a.getBlockType().getChildBlockItems(this.getItems()):null,maxBlocks:this.getMaxBlocks()});n.$container.before(l.$container),l.on("newBlock",(function(t){return e["@newBlock"]({blockType:t.blockType,index:i,level:n.getLevel()})})),l.initUi(),!1!==t.animate&&l.$container.css({opacity:0,marginBottom:-l.$container.outerHeight()}).velocity({opacity:1,marginBottom:10},"fast",(function(t){return o().requestAnimationFrame((function(){return o().scrollContainerToElement(l.$container)}))})),this._tempButtons=l,this._tempButtonsBlock=this._findParentBlock(n),this._tempButtons.updateButtonStates(r,this._checkMaxChildren(this._tempButtonsBlock),this._tempButtonsBlock)},"@copyBlock":function(t){var e=this,n=[],i=0,o=this._ownerId;this._blockBatch(t.block,(function(t){if(!(i>0&&-1!==n[n.length-1].indexOf(t))){var o=[];o.push.apply(o,[t].concat(X(e._findChildBlocks(t,!0)))),n.push(o),i+=o.length}}));for(var a={field:this._name,blocks:[]},l=0,s=n;l<s.length;l++){var c,d=s[l],h=d[0].getLevel(),u=Q(d);try{for(u.s();!(c=u.n()).done;){var p=c.value,b={type:p.getBlockType().getId(),level:p.getLevel()-h,content:p.getContent(),ownerId:o};p.isEnabled()&&(b.enabled=1),p.isExpanded()||(b.collapsed=1),a.blocks.push(b)}}catch(t){u.e(t)}finally{u.f()}}window.localStorage.setItem("neo:copy",JSON.stringify(a)),this._updateButtons();var f=1===i?"1 block copied":"{n} blocks copied";r().cp.displayNotice(r().t("neo",f,{n:i}))},"@pasteBlock":function(t){var e=t.block,n=e.getLevel(),i=window.localStorage.getItem("neo:copy");if(i){var o,a=JSON.parse(i).blocks,r=Q(a);try{for(r.s();!(o=r.n()).done;){var l=o.value;l.level+=n}}catch(t){r.e(t)}finally{r.f()}c.enter(this._templateNs);var s={namespace:c.toFieldName(),locale:this._locale,blocks:a};c.leave(),this._duplicate(s,e)}},"@duplicateBlock":function(t){var e=t.block,n=this._blocks.indexOf(e),i=this._findChildBlocks(n,!0),o=this._ownerId,a=function(t){return{collapsed:0|!t.isExpanded(),content:t.getContent(),enabled:0|t.isEnabled(),level:t.getLevel(),ownerId:o,type:t.getBlockType().getId()}};c.enter(this._templateNs);var r={namespace:c.toFieldName(),locale:this._locale,blocks:[a(e)].concat(X(i.map(a)))};c.leave(),this._duplicate(r,e)}});var ot="undefined"!=typeof window?window:void 0,at=[];ot.Neo={Input:it,inputs:at,createInput:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new it(t);return at.push(e),e}}})()})();
{"version":3,"file":"neo-main.js","mappings":"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","sources":["webpack://craft-neo/webpack/bootstrap","webpack://craft-neo/webpack/runtime/compat get default export","webpack://craft-neo/webpack/runtime/define property getters","webpack://craft-neo/webpack/runtime/hasOwnProperty shorthand","webpack://craft-neo/external var \"jQuery\"","webpack://craft-neo/external var \"Garnish\"","webpack://craft-neo/external var \"Craft\"","webpack://craft-neo/./client/src/namespace.js","webpack://craft-neo/./client/src/input/BlockSort.js","webpack://craft-neo/./client/src/input/BlockTypeTab.js","webpack://craft-neo/./client/src/input/BlockType.js","webpack://craft-neo/./client/src/input/Group.js","webpack://craft-neo/./client/src/jquery-extensions.js","webpack://craft-neo/./client/src/input/Block.js","webpack://craft-neo/./client/src/plugins/cpfieldinspect/main.js","webpack://craft-neo/./client/src/input/Buttons.js","webpack://craft-neo/./client/src/input/Input.js","webpack://craft-neo/./client/src/main.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = jQuery;","const __WEBPACK_NAMESPACE_OBJECT__ = Garnish;","const __WEBPACK_NAMESPACE_OBJECT__ = Craft;","export default {\n\n  _stack: [[]],\n\n  enter (segments, join = true) {\n    if (typeof segments === 'string') {\n      segments = this.fromFieldName(segments)\n    }\n\n    if (join) {\n      const joined = this.getNamespace()\n      joined.push(...segments)\n\n      segments = joined\n    }\n\n    this._stack.push(segments)\n  },\n\n  enterByFieldName (fieldName, join = true) {\n    this.enter(this.fromFieldName(fieldName), join)\n  },\n\n  leave () {\n    return this._stack.length > 1\n      ? this._stack.pop()\n      : this.getNamespace()\n  },\n\n  getNamespace () {\n    return Array.from(this._stack[this._stack.length - 1])\n  },\n\n  parse (value) {\n    if (typeof value === 'string') {\n      if (value.indexOf('[') > -1) {\n        return this.fromFieldName(value)\n      }\n\n      if (value.indexOf('-') > -1) {\n        return value.split('-')\n      }\n\n      if (value.indexOf('.') > -1) {\n        return value.split('.')\n      }\n\n      return value\n    }\n\n    return Array.from(value)\n  },\n\n  value (value, separator = '-') {\n    const segments = this.getNamespace()\n    segments.push(value)\n\n    return segments.join(separator)\n  },\n\n  fieldName (fieldName = '') {\n    const prefix = this.toFieldName()\n\n    if (prefix) {\n      return prefix + fieldName.replace(/([^'\"[\\]]+)([^'\"]*)/, '[$1]$2')\n    }\n\n    return fieldName\n  },\n\n  toString (separator = '-') {\n    return this.getNamespace().join(separator)\n  },\n\n  toFieldName () {\n    const segments = this.getNamespace()\n\n    switch (segments.length) {\n      case 0: return ''\n      case 1: return segments[0]\n    }\n\n    return segments[0] + '[' + segments.slice(1).join('][') + ']'\n  },\n\n  fromFieldName (fieldName) {\n    return fieldName.match(/[^[\\]\\s]+/g) || []\n  }\n}\n","import $ from 'jquery'\nimport Garnish from 'garnish'\n\nconst BlockSort = Garnish.Drag.extend({\n\n  $container: null,\n  blocks: null,\n  maxTopBlocks: 0,\n\n  _draggeeBlocks: null,\n\n  init (items, settings) {\n    if (typeof settings === 'undefined' && $.isPlainObject(items)) {\n      settings = items\n      items = null\n    }\n\n    settings = $.extend({}, BlockSort.defaults, settings)\n    settings.axis = Garnish.Y_AXIS\n\n    this.base(items, settings)\n\n    this.$container = settings.container\n    this.blocks = []\n    this.maxTopBlocks = settings.maxTopBlocks\n  },\n\n  getHelperTargetX () {\n    return this.$draggee.offset().left\n  },\n\n  getHelperTargetY () {\n    const magnet = this.settings.magnetStrength\n\n    if (magnet !== 1) {\n      const draggeeOffsetY = this.$draggee.offset().top\n      return draggeeOffsetY + ((this.mouseY - this.mouseOffsetY - draggeeOffsetY) / magnet)\n    }\n\n    return this.base()\n  },\n\n  getBlockByElement ($block) {\n    return this.blocks.find(block => block.$container.is($block))\n  },\n\n  getParentBlock (block) {\n    const $parentBlock = block.$container.parent().closest('.ni_block')\n\n    return $parentBlock.length > 0 ? this.getBlockByElement($parentBlock) : false\n  },\n\n  onDragStart () {\n    const that = this\n\n    this._draggeeBlocks = []\n    this.$draggee.each(function () {\n      that._draggeeBlocks.push(that.getBlockByElement(this))\n    })\n\n    this.base()\n    this._calculateMidpoints()\n  },\n\n  onDrag () {\n    const midpoint = this._getClosestMidpoint()\n\n    if (midpoint) {\n      this._moveDraggeeToBlock(midpoint.block, midpoint.type, midpoint.direction)\n    }\n\n    this.base()\n  },\n\n  onDragStop () {\n    const that = this\n    this.$draggee.each(function () {\n      const $block = $(this)\n      const block = that.getBlockByElement($block)\n      const isRoot = $block.parent().is(that.$container)\n\n      if (isRoot) {\n        block.setLevel(1)\n      } else {\n        const parentBlock = that.getParentBlock(block)\n\n        block.setLevel(parentBlock.getLevel() + 1)\n      }\n\n      $block.find('.ni_block').each(function () {\n        const $childBlock = $(this)\n        const childBlock = that.getBlockByElement($childBlock)\n        const parentBlock = that.getParentBlock(childBlock)\n\n        childBlock.setLevel(parentBlock.getLevel() + 1)\n      })\n    })\n\n    this.returnHelpersToDraggees()\n\n    this.base()\n  },\n\n  addBlock (block) {\n    this.blocks.push(block)\n\n    this.addItems(block.$container)\n  },\n\n  removeBlock (block) {\n    this.blocks = this.blocks.filter(b => b !== block)\n\n    this.removeItems(block.$container)\n  },\n\n  _getClosestMidpoint () {\n    let minDistance = Number.MAX_VALUE\n    let maxDistance = Number.MIN_VALUE\n    let closest = null\n\n    for (const midpoint of this._currentMidpoints) {\n      if (midpoint.direction === BlockSort.DIRECTION_UP) {\n        const compareY = this.mouseY - this.mouseOffsetY\n\n        if (compareY < midpoint.position && midpoint.position < minDistance) {\n          minDistance = midpoint.position\n          closest = midpoint\n        }\n      } else {\n        const compareY = this.mouseY - this.mouseOffsetY + this._draggeeBlockHeight\n\n        if (compareY > midpoint.position && midpoint.position > maxDistance) {\n          maxDistance = midpoint.position\n          closest = midpoint\n        }\n      }\n    }\n\n    return closest\n  },\n\n  _calculateMidpoints () {\n    const margin = 10\n\n    this._draggeeBlockY = this.$draggee.offset().top\n    this._draggeeBlockHeight = this.$draggee.height() + margin\n\n    this._currentMidpoints = []\n\n    for (const block of this.blocks) {\n      if (block.$container.closest(this.$draggee).length === 0) {\n        const midpoints = this._getBlockMidpoints(block)\n\n        for (const type of Object.keys(midpoints)) {\n          const position = midpoints[type]\n          const direction = this._draggeeBlockY > position\n            ? BlockSort.DIRECTION_UP\n            : BlockSort.DIRECTION_DOWN\n\n          this._currentMidpoints.push({\n            block,\n            position,\n            type,\n            direction\n          })\n        }\n      }\n    }\n\n    const endMidpoint = this.$container.offset().top + this.$container.height() + (margin / 2)\n    this._currentMidpoints.push({\n      block: null,\n      position: endMidpoint,\n      type: BlockSort.TYPE_END,\n      direction: BlockSort.DIRECTION_DOWN\n    })\n  },\n\n  _getBlockMidpoints (block) {\n    const midpoints = {}\n\n    const border = 1\n    const margin = 10\n    const padding = 14\n\n    const isAncestorCollapsed = (block.$container.parent().closest('.ni_block.is-collapsed').length > 0)\n\n    if (!isAncestorCollapsed) {\n      const offset = block.$container.offset().top\n\n      const isExpanded = block.isExpanded()\n\n      const blockHeight = block.$container.height()\n      const topbarHeight = block.$topbarContainer.height()\n      const childrenHeight = isExpanded ? block.$childrenContainer.height() : 0\n      const preChildrenContentHeight = !(isExpanded && block.$contentContainer.length > 0)\n        ? 0\n        : block.$childrenContainer.length > 0\n          ? block.$childrenContainer.offset().top - block.$contentContainer.offset().top\n          : block.$contentContainer.height()\n\n      const parentBlock = this.getParentBlock(block)\n\n      if (!parentBlock || this._validateDraggeeChildren(parentBlock)) {\n        midpoints[BlockSort.TYPE_CONTENT] = offset + (topbarHeight + preChildrenContentHeight) / 2\n      }\n\n      if (childrenHeight > 0 && block.isExpanded() && this._validateDraggeeChildren(block)) {\n        const buttonsHeight = block.getButtons().$container.height()\n        midpoints[BlockSort.TYPE_CHILDREN] = offset + blockHeight - border - (padding + buttonsHeight + margin) / 2\n      }\n    }\n\n    return midpoints\n  },\n\n  _moveDraggeeToBlock: function (block, type = BlockSort.TYPE_CONTENT, direction = BlockSort.DIRECTION_DOWN) {\n    const parentBlock = block ? this.getParentBlock(block) : null\n    const validChild = this._validateDraggeeChildren(parentBlock)\n\n    switch (type) {\n      case BlockSort.TYPE_CHILDREN:\n        if (this.$draggee.closest(block.$container).length === 0) {\n          block.$blocksContainer.append(this.$draggee)\n        } else if (validChild) {\n          block.$container.after(this.$draggee)\n        }\n        break\n      case BlockSort.TYPE_END:\n        if (validChild) {\n          this.$container.append(this.$draggee)\n        }\n        break\n      default:\n      {\n        if (direction === BlockSort.DIRECTION_UP) {\n          if (validChild) {\n            block.$container.before(this.$draggee)\n          }\n        } else {\n          if (block.getBlockType().isParent() && block.isExpanded() && this._validateDraggeeChildren(block)) {\n            block.$blocksContainer.prepend(this.$draggee)\n          } else if (validChild) {\n            block.$container.after(this.$draggee)\n          }\n        }\n      }\n    }\n\n    this._updateHelperAppearance()\n    this._calculateMidpoints()\n  },\n\n  _validateDraggeeChildren (block) {\n    // If any of the draggee blocks would exceed the field's max levels, we can't allow the move\n    const field = block ? block.getField() : this._draggeeBlocks[0].getField()\n    const maxLevels = field.getMaxLevels()\n\n    if (maxLevels > 0) {\n      const parentLevel = block ? block.getLevel() : -1\n      const firstDraggeeLevel = this._draggeeBlocks[0].getLevel()\n      const blockExceedsMax = b => b.getLevel() - firstDraggeeLevel + parentLevel + 1 >= maxLevels\n      const blockOrDescendantExceedsMax = b => {\n        const descendants = b.getChildren(field.getBlocks(), true)\n\n        return blockExceedsMax(b) || descendants.some(blockOrDescendantExceedsMax)\n      }\n\n      if (this._draggeeBlocks.filter(blockOrDescendantExceedsMax).length > 0) {\n        return false\n      }\n    }\n\n    // If no block, then we're checking at the top level\n    if (!block) {\n      const that = this\n      const topBlocks = this.$container.children('.ni_block:not(.is-disabled)')\n      let topBlocksCount = topBlocks.length\n\n      for (const draggeeBlock of this._draggeeBlocks) {\n        // Is this block allowed at the top level?\n        if (!draggeeBlock.getBlockType().getTopLevel()) {\n          return false\n        }\n      }\n\n      // If the block is already at the top level, don't count it for max top level block check purposes\n      topBlocks.each(function () {\n        if (that._draggeeBlocks.includes(that.getBlockByElement(this))) {\n          topBlocksCount--\n        }\n      })\n\n      // If this move would exceed the field's max top level blocks, we can't allow it\n      if (this.maxTopBlocks > 0 && topBlocksCount >= this.maxTopBlocks) {\n        return false\n      }\n\n      return true\n    }\n\n    const blockType = block.getBlockType()\n    const maxChildBlocks = blockType.getMaxChildBlocks()\n\n    const blockChildren = block.$childrenContainer.children('.ni_blocks').children('.ni_block')\n    let blockChildCount = blockChildren.length\n    const blockChildrenWithoutDraggees = []\n    const that = this\n\n    // If the block is already a child block, don't count it for validation purposes\n    blockChildren.each(function () {\n      const childBlock = that.getBlockByElement(this)\n\n      if (that._draggeeBlocks.includes(childBlock)) {\n        blockChildCount--\n      } else {\n        blockChildrenWithoutDraggees.push(childBlock)\n      }\n    })\n\n    // Check whether the move would make the potential parent block exceed its max child blocks\n    if (maxChildBlocks > 0 && blockChildCount >= maxChildBlocks) {\n      return false\n    }\n\n    const checkedDraggeeBlocks = []\n\n    for (const draggeeBlock of this._draggeeBlocks) {\n      // Check whether the block is a valid child block for the parent's block type\n      if (!blockType.isValidChildBlock(draggeeBlock)) {\n        return false\n      }\n\n      // Check whether this move would cause any max sibling block type violations, unless we\n      // checked this block already\n      if (checkedDraggeeBlocks.includes(draggeeBlock)) {\n        continue\n      }\n\n      const draggeeBlockType = draggeeBlock.getBlockType()\n      const maxSiblingBlocks = draggeeBlockType.getMaxSiblingBlocks()\n\n      // Also don't bother checking for max sibling block type violations if max sibling\n      // blocks hasn't been set\n      if (maxSiblingBlocks === 0) {\n        continue\n      }\n\n      const draggeeBlocksOfType = this._draggeeBlocks.filter(b => b.getBlockType().getHandle() === draggeeBlockType.getHandle())\n      const siblingBlocksOfType = blockChildrenWithoutDraggees.filter(b => b.getBlockType().getHandle() === draggeeBlockType.getHandle())\n\n      if (siblingBlocksOfType.length + draggeeBlocksOfType.length > maxSiblingBlocks) {\n        return false\n      }\n\n      checkedDraggeeBlocks.push(...draggeeBlocksOfType)\n    }\n\n    return true\n  },\n\n  _updateHelperAppearance () {\n    for (const $helper of this.helpers) {\n      const id = $helper.data('neo-b-id')\n      const block = this.blocks.find(b => b.$container.data('neo-b-id') === id)\n\n      $helper.css({\n        width: block.$container.width() + 1,\n        height: block.$container.height()\n      })\n    }\n  }\n\n}, {\n\n  TYPE_CONTENT: 'content',\n  TYPE_CHILDREN: 'children',\n  TYPE_END: 'end',\n  DIRECTION_UP: 'up',\n  DIRECTION_DOWN: 'down',\n\n  defaults: {\n    container: null,\n    magnetStrength: 1\n  }\n})\n\nexport default BlockSort\n","import Garnish from 'garnish'\n\nconst _defaults = {\n  name: '',\n  errors: []\n}\n\nexport default Garnish.Base.extend({\n\n  init (settings = {}) {\n    settings = Object.assign({}, _defaults, settings)\n\n    this._name = settings.name\n    this._errors = settings.errors\n  },\n\n  getErrors () { return Array.from(this._errors) },\n\n  getName () { return this._name }\n})\n","import Garnish from 'garnish'\n\nimport Tab from './BlockTypeTab'\n\nconst _defaults = {\n  id: -1,\n  fieldLayoutId: -1,\n  sortOrder: 0,\n  name: '',\n  handle: '',\n  maxBlocks: 0,\n  maxSiblingBlocks: 0,\n  maxChildBlocks: 0,\n  childBlocks: false,\n  topLevel: true,\n  tabs: [],\n  hasChildBlocksUiElement: false\n}\n\nexport default Garnish.Base.extend({\n\n  init (settings = {}) {\n    settings = Object.assign({}, _defaults, settings)\n\n    this._id = settings.id | 0\n    this._fieldLayoutId = settings.fieldLayoutId | 0\n    this._sortOrder = settings.sortOrder | 0\n    this._name = settings.name\n    this._handle = settings.handle\n    this._description = settings.description\n    this._minBlocks = settings.minBlocks | 0\n    this._maxBlocks = settings.maxBlocks | 0\n    this._minSiblingBlocks = settings.maxSiblingBlocks | 0\n    this._maxSiblingBlocks = settings.maxSiblingBlocks | 0\n    this._minChildBlocks = settings.minChildBlocks | 0\n    this._maxChildBlocks = settings.maxChildBlocks | 0\n    this._childBlocks = settings.childBlocks\n    this._topLevel = settings.topLevel\n    this._tabs = settings.tabs.tabNames?.map(tab => tab instanceof Tab ? tab : new Tab({ name: tab })) ?? []\n    this._html = settings.tabs.html ?? ''\n    this._js = settings.tabs.js ?? ''\n    this._hasChildBlocksUiElement = settings.hasChildBlocksUiElement\n  },\n\n  getType () { return 'blockType' },\n  getId () { return this._id },\n  getFieldLayoutId () { return this._fieldLayoutId },\n  getSortOrder () { return this._sortOrder },\n  getName () { return this._name },\n  getHandle () { return this._handle },\n  getDescription () { return this._description },\n  getMinBlocks () { return this._minBlocks },\n  getMaxBlocks () { return this._maxBlocks },\n  getMinSiblingBlocks () { return this._minSiblingBlocks },\n  getMaxSiblingBlocks () { return this._maxSiblingBlocks },\n  getMinChildBlocks () { return this._minChildBlocks },\n  getMaxChildBlocks () { return this._maxChildBlocks },\n  getChildBlocks () { return this._childBlocks },\n  getTopLevel () { return this._topLevel },\n  getTabs () { return Array.from(this._tabs) },\n\n  getHtml (blockId = null) {\n    return this._replaceBlockIdPlaceholder(this._html, blockId)\n  },\n\n  getJs (blockId = null) {\n    return this._replaceBlockIdPlaceholder(this._js, blockId)\n  },\n\n  _replaceBlockIdPlaceholder (input, blockId = null) {\n    return blockId !== null ? input.replace(/__NEOBLOCK__/g, blockId) : input\n  },\n\n  getChildBlockItems (items) {\n    const firstPass = items.filter(item => item.getType() === 'group' || this.hasChildBlock(item.getHandle()))\n    return firstPass.filter((item, i) => {\n      if (item.getType() === 'group') {\n        const nextItem = firstPass[i + 1]\n        return nextItem && nextItem.getType() !== 'group'\n      }\n\n      return true\n    })\n  },\n\n  isParent () {\n    const cb = this.getChildBlocks()\n    return cb === true || cb === '*' || (Array.isArray(cb) && cb.length > 0)\n  },\n\n  hasChildBlock (handle) {\n    const cb = this.getChildBlocks()\n    return cb === true || cb === '*' || (Array.isArray(cb) && cb.includes(handle))\n  },\n\n  isValidChildBlock (block) {\n    return this.hasChildBlock(block.getBlockType().getHandle())\n  },\n\n  hasChildBlocksUiElement () {\n    return this._hasChildBlocksUiElement\n  }\n})\n","import Garnish from 'garnish'\n\nconst _defaults = {\n  id: -1,\n  sortOrder: 0,\n  alwaysShowDropdown: null,\n  name: ''\n}\n\nexport default Garnish.Base.extend({\n\n  init (settings = {}) {\n    settings = Object.assign({}, _defaults, settings)\n\n    this._id = settings.id | 0\n    this._sortOrder = settings.sortOrder | 0\n    this._alwaysShowDropdown = settings.alwaysShowDropdown\n    this._name = settings.name\n  },\n\n  getType () { return 'group' },\n  getId () { return this._id },\n  getSortOrder () { return this._sortOrder },\n  getName () { return this._name },\n  getAlwaysShowDropdown () { return this._alwaysShowDropdown },\n  isBlank () { return !this._name }\n})\n","import $ from 'jquery'\n\n// @see http://stackoverflow.com/a/12903503/556609\n$.fn.insertAt = function (index, $parent) {\n  return this.each(function () {\n    if (index === 0) {\n      $parent.prepend(this)\n    } else {\n      $parent.children().eq(index - 1).after(this)\n    }\n  })\n}\n","import $ from 'jquery'\nimport '../jquery-extensions'\n\nimport Garnish from 'garnish'\nimport Craft from 'craft'\n\nimport NS from '../namespace'\n\nimport { addFieldLinks } from '../plugins/cpfieldinspect/main'\n\nconst _defaults = {\n  namespace: [],\n  blockType: null,\n  id: null,\n  level: 1,\n  buttons: null,\n  enabled: true,\n  collapsed: false,\n  modified: true,\n  showButtons: true,\n  showBlockTypeHandle: false\n}\n\nconst _resources = {}\n\nconst _escapeMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '/': '&#x2F;'\n}\n\nfunction _resourceFilter () {\n  let url = this.href || this.src\n\n  if (url) {\n    const paramIndex = url.indexOf('?')\n\n    url = (paramIndex < 0 ? url : url.substr(0, paramIndex))\n\n    const isNew = !Object.prototype.hasOwnProperty.call(_resources, url)\n    _resources[url] = 1\n\n    return isNew\n  }\n\n  return true\n}\n\nfunction _escapeHTML (str) {\n  return str ? str.replace(/[&<>\"'/]/g, s => _escapeMap[s]) : ''\n}\n\nfunction _limit (s, l = 40) {\n  s = s || ''\n  return s.length > l ? s.slice(0, l - 3) + '...' : s\n}\n\nexport default Garnish.Base.extend({\n\n  _templateNs: [],\n  _field: null,\n  _blockType: null,\n  _initialised: false,\n  _expanded: true,\n  _enabled: true,\n  _modified: true,\n  _initialState: null,\n  _forceModified: false,\n\n  init (settings = {}, generateElement = false) {\n    settings = Object.assign({}, _defaults, settings)\n\n    this._templateNs = NS.parse(settings.namespace)\n    this._field = settings.field\n    this._blockType = settings.blockType\n    this._id = settings.id\n    this._buttons = settings.buttons\n    this._initialEnabled = settings.enabled\n    this._modified = settings.modified\n    this._showButtons = settings.showButtons\n    this._renderOldChildBlocksContainer = !settings.blockType.hasChildBlocksUiElement()\n    this.$container = generateElement\n      ? this._generateElement(settings.showBlockTypeHandle)\n      : $(`[data-neo-b-id=${this._id}]`)\n\n    const $neo = this.$container.find('[data-neo-b]')\n    this.$bodyContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.body\"]`)\n    this.$contentContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.content\"]`)\n    this.$childrenContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.children\"]`)\n    this.$childrenWarningsContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.childrenWarnings\"]`)\n    this.$collapsedChildrenContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.collapsedChildren\"]`)\n    this.$blocksContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.blocks\"]`)\n    this.$buttonsContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.buttons\"]`)\n    this.$topbarContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.topbar\"]`)\n    this.$topbarLeftContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.topbarLeft\"]`)\n    this.$topbarRightContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.topbarRight\"]`)\n    this.$handleContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.handle\"]`)\n    this.$tabsContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.tabs\"]`)\n    this.$tabContainer = this.$contentContainer.children('[data-layout-tab]')\n    this.$menuContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.menu\"]`)\n    this.$previewContainer = $neo.filter(`[data-neo-b=\"${this._id}.container.preview\"]`)\n    this.$tabButton = $neo.filter(`[data-neo-b=\"${this._id}.button.tab\"]`)\n    this.$settingsButton = $neo.filter(`[data-neo-b=\"${this._id}.button.actions\"]`)\n    this.$togglerButton = $neo.filter(`[data-neo-b=\"${this._id}.button.toggler\"]`)\n    this.$tabsButton = $neo.filter(`[data-neo-b=\"${this._id}.button.tabs\"]`)\n    this.$enabledInput = $neo.filter(`[data-neo-b=\"${this._id}.input.enabled\"]`)\n    this.$levelInput = $neo.filter(`[data-neo-b=\"${this._id}.input.level\"]`)\n    this.$status = $neo.filter(`[data-neo-b=\"${this._id}.status\"]`)\n    this.$sortOrder = $neo.filter(`[data-neo-b=\"${this._id}.sortOrder\"]`)\n    this.$form = this.$container.closest('form')\n\n    if (this._buttons) {\n      this._buttons.on('newBlock', e => this.trigger('newBlock', Object.assign(e, { level: this.getLevel() + 1 })))\n      this.$buttonsContainer.append(this._buttons.$container)\n    }\n\n    let hasErrors = false\n    if (this._blockType) {\n      for (const tab of this._blockType.getTabs()) {\n        const selector = `[data-neo-b-info=\"${tab.getName()}\"]`\n\n        if (this.$tabContainer.filter(selector).find('ul.errors').length > 0) {\n          hasErrors = true\n          this.$tabButton.filter(selector).addClass('error')\n        }\n      }\n    }\n\n    this.setLevel(settings.level)\n    this.toggleExpansion(hasErrors ? true : !settings.collapsed, false, false)\n    this.toggleShowButtons(this._showButtons)\n\n    this.addListener(this.$topbarContainer, 'dblclick', '@doubleClickTitle')\n  },\n\n  _generateElement (showHandle = false) {\n    NS.enter(this._templateNs)\n    const baseInputName = NS.toFieldName()\n    const baseInputId = NS.toString('-')\n    NS.leave()\n\n    const type = this._blockType\n    const typeTabs = type.getTabs()\n    const hasTabs = typeTabs.length > 0\n    const isParent = type.isParent()\n    const actionBtnLabel = `${type.getName()} ${Craft.t('neo', 'Actions')}`\n    const actionMenuId = `neoblock-action-menu-${this._id}`\n    const tabsBtnLabel = `${type.getName()} ${Craft.t('neo', 'Tabs')}`\n    const tabsMenuId = `neoblock-tabs-menu-${this._id}`\n    const sortOrderName = `${this._templateNs[0]}[${this._templateNs.slice(1, this._templateNs.length - 2).join('][')}][sortOrder]`\n    const elementHtml = []\n    elementHtml.push(`\n      <div class=\"ni_block ni_block--${type.getHandle()} is-${this._collapsed ? 'collapsed' : 'expanded'} ${!hasTabs && !isParent ? 'is-empty' : ''} ${isParent ? 'is-parent' : ''}\" data-neo-b-id=\"${this._id}\" data-neo-b-name=\"${type.getName()}\">\n        <input type=\"hidden\" name=\"${baseInputName}[type]\" value=\"${type.getHandle()}\">\n        <input type=\"hidden\" name=\"${baseInputName}[enabled]\" value=\"${this._enabled ? '1' : ''}\" data-neo-b=\"${this._id}.input.enabled\">\n        <input type=\"hidden\" name=\"${baseInputName}[level]\" value=\"${this._level}\" data-neo-b=\"${this._id}.input.level\">\n        <input type=\"hidden\" name=\"${sortOrderName}[]\" value=\"${this._id}\" data-neo-b=\"${this._id}.input.sortOrder\">\n\n        <div class=\"ni_block_topbar\" data-neo-b=\"${this._id}.container.topbar\">\n          <div class=\"ni_block_topbar_left\" data-neo-b=\"${this._id}.container.topbarLeft\">\n            <div class=\"ni_block_topbar_item\" data-neo-b=\"${this._id}.select\">\n              <div class=\"checkbox block-checkbox\" title=\"${Craft.t('neo', 'Select')} aria-label=\"${Craft.t('neo', 'Select')}\"></div>\n            </div>\n            <div class=\"ni_block_topbar_item title\">\n              <span class=\"blocktype\" data-neo-b=\"${this._id}.select\">${type.getName()}</span>\n            </div>\n            <div class=\"ni_block_topbar_item preview-container clip-text\">\n              <span class=\"preview\" data-neo-b=\"${this._id}.container.preview\">&nbsp;</span>\n            </div>\n          </div>\n          <div class=\"ni_block_topbar_right\" data-neo-b=\"${this._id}.container.topbarRight\">\n            <div class=\"ni_block_topbar_item size-full tabs\">`)\n\n    if (hasTabs || isParent) {\n      elementHtml.push(`\n              <div class=\"tabs_trigger\" data-neo-b=\"${this._id}.button.toggler\"></div>`)\n    }\n\n    if (typeTabs.length > 1) {\n      elementHtml.push(`\n              <div class=\"tabs_inner\" data-neo-b=\"${this._id}.container.tabs\">`)\n\n      for (let i = 0; i < typeTabs.length; i++) {\n        const tabName = typeTabs[i].getName()\n        elementHtml.push(`\n                <a class=\"tab ${!i ? 'is-selected' : ''}\" data-neo-b=\"${this._id}.button.tab\" data-neo-b-info=\"${tabName}\">${tabName}</a>`)\n      }\n\n      elementHtml.push(`\n              </div>\n              <div>\n                <button type=\"button\" role=\"button\" title=${Craft.t('neo', 'Tabs')} aria-controls=\"${tabsMenuId}\" aria-label=\"${tabsBtnLabel}\" data-disclosure-trigger data-neo-b=\"${this._id}.button.tabs\" class=\"tabs_btn menubtn\">\n                  ${typeTabs[0].getName()}\n                </button>\n                <div id=\"${tabsMenuId}\" class=\"neo_block_tabs-menu menu menu--disclosure\">\n                  <ul>`)\n\n      for (let i = 0; i < typeTabs.length; i++) {\n        const tabName = typeTabs[i].getName()\n        elementHtml.push(`\n                    <li>\n                      <a${!i ? ' class=\"is-selected\"' : ''} href=\"#\" type=\"button\" role=\"button\" aria-label=\"${tabName}\" data-neo-b=\"${this._id}.button.tab\" data-neo-b-info=\"${tabName}\">${tabName}</a>\n                    </li>`)\n      }\n\n      elementHtml.push(`\n                  </ul>\n                </div>\n              </div>`)\n    }\n\n    elementHtml.push(`\n            </div>\n            <div class=\"ni_block_topbar_item hidden\" data-neo-b=\"${this._id}.status\">\n              <div class=\"status off\" title=\"${Craft.t('neo', 'Disabled')}\"></div>\n            </div>\n            <div class=\"ni_block_topbar_item block-settings\">\n              <div>\n                <button class=\"btn settings icon menubtn\" type=\"button\" role=\"button\" title=\"${Craft.t('neo', 'Actions')}\" aria-controls=\"${actionMenuId}\" aria-label=\"${actionBtnLabel}\" data-disclosure-trigger data-neo-b=\"${this._id}.button.actions\"></button>\n                <div id=\"${actionMenuId}\" class=\"menu menu--disclosure\" data-neo-b=\"${this._id}.container.menu\">\n                  <ul class=\"padded\">`)\n\n    if (hasTabs || isParent) {\n      elementHtml.push(`\n                    <li><a data-icon=\"collapse\" data-action=\"collapse\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Collapse')}\">${Craft.t('neo', 'Collapse')}</a></li>\n                    <li class=\"hidden\"><a data-icon=\"expand\" data-action=\"expand\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Expand')}\">${Craft.t('neo', 'Expand')}</a></li>`)\n    }\n\n    elementHtml.push(`\n                    <li><a data-icon=\"disabled\" data-action=\"disable\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Disable')}\">${Craft.t('neo', 'Disable')}</a></li>\n                    <li class=\"hidden\"><a data-icon=\"enabled\" data-action=\"enable\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Enable')}\">${Craft.t('neo', 'Enable')}</a></li>\n                    <li class=\"hidden\"><a data-icon=\"uarr\" data-action=\"moveUp\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Move up')}\">${Craft.t('neo', 'Move up')}</a></li>\n                    <li class=\"hidden\"><a data-icon=\"darr\" data-action=\"moveDown\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Move down')}\">${Craft.t('neo', 'Move down')}</a></li>\n                  </ul>\n                  <hr>\n                  <ul class=\"padded\">\n                    <li><a data-icon=\"plus\" data-action=\"add\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Add block above')}\">${Craft.t('neo', 'Add block above')}</a></li>\n                    <li><a data-icon=\"field\" data-action=\"copy\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Copy')}\">${Craft.t('neo', 'Copy')}</a></li>\n                    <li><a data-icon=\"brush\" data-action=\"paste\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Paste')}\">${Craft.t('neo', 'Paste')}</a></li>\n                    <li><a data-icon=\"share\" data-action=\"duplicate\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Clone')}\">${Craft.t('neo', 'Clone')}</a></li>\n                  </ul>\n                  <hr>\n                  <ul class=\"padded\">\n                    <li><a class=\"error\" data-icon=\"remove\" data-action=\"delete\" href=\"#\" type=\"button\" role=\"button\" aria-label=\"${Craft.t('neo', 'Delete')}\">${Craft.t('neo', 'Delete')}</a></li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n            <div class=\"ni_block_topbar_item block-reorder\">\n              <a class=\"move icon\" title=\"${Craft.t('neo', 'Reorder')}\" aria-label=\"${Craft.t('neo', 'Reorder')}\" role=\"button\" data-neo-b=\"${this._id}.button.move\"></a>\n            </div>\n          </div>\n        </div>`)\n\n    if (hasTabs || isParent) {\n      elementHtml.push(`\n        <div class=\"ni_block_body\" data-neo-b=\"${this._id}.container.body\">`)\n\n      if (hasTabs) {\n        elementHtml.push(`\n          <div class=\"ni_block_content\" data-neo-b=\"${this._id}.container.content\">\n            ${type.getHtml(this._id)}\n          </div>`)\n      }\n\n      if (isParent && this._renderOldChildBlocksContainer) {\n        elementHtml.push(`\n          <div class=\"ni_block_children\" data-neo-b=\"${this._id}.container.children\">\n            <div class=\"ni_blocks\" data-neo-b=\"${this._id}.container.blocks\">\n            </div>\n            <div data-neo-b=\"${this._id}.container.buttons\" class=\"hidden\"></div>\n            <div data-neo-b=\"${this._id}.container.childrenWarnings\" class=\"hidden\">\n              <p class=\"first warning with-icon\">${Craft.t('neo', \"This Neo field's maximum number of levels has been reached, so no child blocks can be added here.\")}</p>\n            </div>\n          </div>`)\n      }\n\n      elementHtml.push(`\n        </div>`)\n    }\n\n    if (isParent) {\n      elementHtml.push(`\n        <div class=\"ni_block_collapsed-children\" data-neo-b=\"${this._id}.container.collapsedChildren\"></div>`)\n    }\n\n    elementHtml.push(`\n      <div data-neo=\"container.buttons\"></div>`)\n\n    const $elementHtml = $(elementHtml.join(''))\n\n    if (showHandle) {\n      $('<div/>')\n        .addClass('ni_block_topbar_item handle')\n        .prop('data-neo-b', `${this._id}.container.handle`)\n        .append(Craft.ui.createCopyTextBtn({\n          id: `${baseInputId}-${type.getHandle()}-attribute`,\n          class: ['code', 'small', 'light'],\n          value: type.getHandle()\n        }))\n        .insertAfter($elementHtml.find('.ni_block_topbar_item.title'))\n    }\n\n    return $elementHtml\n  },\n\n  initUi (callInitUiElements = true) {\n    if (this._initialised) {\n      // Nothing to do here\n      return\n    }\n\n    this.$foot = $(this._blockType.getJs(this._id)).filter(_resourceFilter)\n    Garnish.$bod.append(this.$foot)\n\n    if (callInitUiElements) {\n      Craft.initUiElements(this.$contentContainer)\n    }\n\n    this._tabsMenu = this.$tabsButton.data('trigger') || new Garnish.DisclosureMenu(this.$tabsButton)\n    this._tabsMenu.on('show', () => this.$container.addClass('active'))\n    this._tabsMenu.on('hide', () => this.$container.removeClass('active'))\n\n    this.$tabButton = this.$tabButton.add(this._tabsMenu.$container.find(`[data-neo-b=\"${this._id}.button.tab\"]`))\n    this.addListener(this.$tabButton, 'click', this['@setTab'])\n    this.addListener(this.$tabButton, 'keydown', this._handleTabKeydown)\n\n    this._settingsMenu = this.$settingsButton.data('trigger') || new Garnish.DisclosureMenu(this.$settingsButton)\n    this._settingsMenu.on('show', () => this.$container.addClass('active'))\n    this._settingsMenu.on('hide', () => this.$container.removeClass('active'))\n\n    this.$menuContainer = this._settingsMenu.$container\n    this.addListener(this.$menuContainer.find('[data-action]'), 'click', this._handleActionClick)\n    this.addListener(this.$menuContainer.find('[data-action]'), 'keydown', this._handleActionKeydown)\n\n    this.toggleEnabled(this._initialEnabled)\n\n    this._initialised = true\n    this._buttons?.initUi()\n\n    Garnish.requestAnimationFrame(() => this.updateResponsiveness())\n\n    // For Matrix blocks inside a Neo block, this listener adds a class name to the block for Neo to style.\n    // Neo applies its own styles to Matrix blocks in an effort to improve the visibility of them, however\n    // when dragging a Matrix block these styles get lost (since a dragged Matrix block loses its context of\n    // being inside a Neo block). Adding this class name to blocks before they are dragged means that the\n    // dragged Matrix block can still have the Neo-specific styles.\n    this.$container.on('mousedown', '.matrixblock', function (e) {\n      $(this).addClass('neo-matrixblock')\n    })\n\n    // Setting up field and block property watching\n    if (!this.isNew()) {\n      this._initialState = {\n        enabled: this._enabled,\n        level: this._level,\n        content: Garnish.getPostData(this.$contentContainer)\n      }\n\n      const detectChange = () => this._detectChange()\n      const observer = new window.MutationObserver(() => setTimeout(detectChange, 200))\n\n      observer.observe(this.$container[0], {\n        attributes: true,\n        childList: true,\n        characterData: true,\n        subtree: true\n      })\n\n      this.$contentContainer.on('propertychange change click', 'input, textarea, select, div.redactor-in', detectChange)\n      this.$contentContainer.on('paste input keyup', 'input:not([type=\"hidden\"]), textarea, div.redactor-in', detectChange)\n\n      this._detectChangeObserver = observer\n\n      // If there's a Super Table field with a static row or min rows set, we need to check for new\n      // rows and force this block's modified state so it saves the new rows\n      if (this.$contentContainer.length > 0 && this.$contentContainer.html().match(/\\[blocks\\]\\[new/)) {\n        this._forceModified = true\n        this.setModified(true)\n        const fieldInputName = this._templateNs[0] + '[' + this._templateNs[1] + ']'\n\n        if (!Craft.modifiedDeltaNames.includes(fieldInputName)) {\n          Craft.modifiedDeltaNames.push(fieldInputName)\n        }\n      }\n    }\n\n    addFieldLinks(this.$contentContainer)\n\n    this.trigger('initUi')\n  },\n\n  destroy () {\n    if (this._initialised) {\n      this.$foot.remove()\n\n      clearInterval(this._detectChangeInterval)\n\n      if (this._detectChangeObserver) {\n        this._detectChangeObserver.disconnect()\n      }\n\n      this.trigger('destroy')\n    }\n  },\n\n  getBlockType () {\n    return this._blockType\n  },\n\n  getId () {\n    return this._id\n  },\n\n  isTopLevel () {\n    return this._level === 1\n  },\n\n  getLevel () {\n    return this._level\n  },\n\n  setLevel (level) {\n    this._level = level | 0\n\n    this.$levelInput.val(`0${this._level}`)\n    this.$container.toggleClass('is-level-odd', !!(this._level % 2))\n    this.$container.toggleClass('is-level-even', !(this._level % 2))\n  },\n\n  setModified (isModified) {\n    this._modified = isModified\n  },\n\n  getButtons () {\n    return this._buttons\n  },\n\n  getSiteId () {\n    if (!this._siteId) {\n      const $siteId = this.$form.find('input[name=\"siteId\"]')\n      this._siteId = $siteId.val()\n    }\n\n    return this._siteId\n  },\n\n  getContent () {\n    const rawContent = Garnish.getPostData(this.$contentContainer)\n    const content = {}\n\n    const setValue = (keys, value) => {\n      let currentSet = content\n\n      for (let i = 0; i < keys.length - 1; i++) {\n        const key = keys[i]\n\n        if (!$.isPlainObject(currentSet[key]) && !$.isArray(currentSet[key])) {\n          currentSet[key] = {}\n        }\n\n        currentSet = currentSet[key]\n      }\n\n      const key = keys[keys.length - 1]\n      currentSet[key] = value\n    }\n\n    for (const rawName of Object.keys(rawContent)) {\n      const fullName = NS.parse(rawName)\n      const name = fullName.slice(this._templateNs.length + 1) // Adding 1 because content is NS'd under [fields]\n\n      // Make sure empty arrays (which can happen with level, enabled, etc. when using the child blocks UI element) are ignored\n      if (!name.length) {\n        continue\n      }\n\n      const value = rawContent[rawName]\n\n      setValue(name, value)\n    }\n\n    return content\n  },\n\n  getParent (blocks = null) {\n    blocks ??= this._field.getBlocks()\n    const level = this.getLevel()\n    let index = blocks.indexOf(this)\n    let blockParent = null\n\n    if (index >= 0 && level > 1) {\n      while (blockParent === null && index > 0) {\n        const currentBlock = blocks[--index]\n        const currentLevel = currentBlock.getLevel()\n\n        if (currentLevel === level - 1) {\n          blockParent = currentBlock\n        }\n      }\n    }\n\n    return blockParent\n  },\n\n  getChildren (blocks = null, descendants = null) {\n    blocks ??= this._field.getBlocks()\n    const level = this.getLevel()\n    let index = blocks.indexOf(this)\n    const childBlocks = []\n\n    if (index >= 0) {\n      let currentBlock = blocks[++index]\n\n      while (currentBlock && currentBlock.getLevel() > level) {\n        const currentLevel = currentBlock.getLevel()\n\n        if (descendants ? currentLevel > level : currentLevel === level + 1) {\n          childBlocks.push(currentBlock)\n        }\n\n        currentBlock = blocks[++index]\n      }\n    }\n\n    return childBlocks\n  },\n\n  getSiblings (blocks = null) {\n    blocks ??= this._field.getBlocks()\n\n    return this.isTopLevel() ? blocks.filter(b => b.isTopLevel()) : this.getParent(blocks).getChildren(blocks)\n  },\n\n  getField () {\n    return this._field\n  },\n\n  updatePreview (condensed = null) {\n    condensed = typeof condensed === 'boolean' ? condensed : false\n\n    const $childFields = this.$childrenContainer.find('.field')\n    const $fields = this.$contentContainer.find('.field').add($childFields)\n    const previewText = []\n\n    $fields.each(function () {\n      const $field = $(this)\n      const $input = $field.children('.input')\n      const fieldType = $field.data('type')\n      const label = $field.children('.heading').children('label').text()\n\n      // We rely on knowing the field type to know how to generate its preview, so if we don't know, skip it.\n      if (fieldType === null) {\n        return\n      }\n\n      let value = false\n\n      switch (fieldType) {\n        case 'craft\\\\fields\\\\Assets':\n          {\n            const values = []\n            const $assets = $input.find('.element')\n\n            $assets.each(function () {\n              const $asset = $(this)\n              const $thumbContainer = $asset.find('.elementthumb')\n              const $thumb = $thumbContainer.children('img')\n              let srcset = $thumb.prop('srcset')\n\n              if (!srcset) {\n                srcset = $thumbContainer.data('srcset')\n              }\n\n              values.push(`<img sizes=\"30px\" srcset=\"${srcset}\">`)\n\n              if (!condensed && $assets.length === 1) {\n                const title = $asset.find('.title').text()\n\n                values.push(_escapeHTML(_limit(title)))\n              }\n            })\n\n            value = values.join(' ')\n          }\n          break\n        case 'craft\\\\fields\\\\Categories':\n        case 'craft\\\\fields\\\\Entries':\n        case 'craft\\\\fields\\\\Tags':\n        case 'craft\\\\fields\\\\Users':\n          {\n            const values = []\n\n            $input.find('.element').each(function () {\n              const title = $(this).find('.title, .label').eq(0).text()\n              values.push(_escapeHTML(_limit(title)))\n            })\n\n            value = values.join(', ')\n          }\n          break\n        case 'craft\\\\fields\\\\Checkboxes':\n          {\n            const values = []\n\n            $input.find('input[type=\"checkbox\"]').each(function () {\n              if (this.checked) {\n                const id = $(this).prop('id')\n                const label = $input.find(`label[for=\"${id}\"]`).text()\n                values.push(_escapeHTML(_limit(label)))\n              }\n            })\n\n            value = values.join(', ')\n          }\n          break\n        case 'craft\\\\fields\\\\Color':\n          {\n            const color = $input.find('input[type=\"color\"]').val()\n            const colorText = $input.find('input[type=\"text\"]').val()\n            const colorRev = $input.find('div.colorhex').text()\n            let background = null\n\n            if (color && colorText) {\n              // Set the selected color.  `colorText` must also be checked, even though it's not used, because\n              // the color type field may still store a color value even if the text field has been cleared.\n              background = `background-color: ${color}`\n            } else if (!color && colorText) {\n              // When a block is initially collapsed, the color type field will not have been set, so the text\n              // field value will need to be used.\n              background = `background-color: ${colorText}`\n            } else if (colorRev) {\n              // Entry revisions will hav a div rather than an input, so use that.\n              background = `background-color: ${colorRev}`\n            } else {\n              // No color value has been set for the field.\n              background = 'background-image: repeating-linear-gradient(-45deg, transparent, transparent 2px, #777 2px, #777 3px)'\n            }\n\n            value = `<div class=\"preview_color\" style=\"${background}\"></div>`\n          }\n          break\n        case 'craft\\\\fields\\\\Date':\n          {\n            const date = _escapeHTML($input.find('.datewrapper input').val())\n            const time = _escapeHTML($input.find('.timewrapper input').val())\n\n            value = date && time ? (date + ' ' + time) : (date || time)\n          }\n          break\n        case 'craft\\\\fields\\\\Dropdown':\n          {\n            const $selected = $input.find('select').children(':selected')\n\n            value = _escapeHTML(_limit($selected.text()))\n          }\n          break\n        case 'craft\\\\fields\\\\Email':\n          value = _escapeHTML(_limit($input.children('input[type=\"email\"]').val()))\n          break\n        case 'craft\\\\fields\\\\Lightswitch':\n          {\n            const enabled = !!$input.find('input').val()\n\n            value = `<span class=\"status${enabled ? ' live' : ''}\"></span>` + _escapeHTML(_limit(label))\n          }\n          break\n        case 'craft\\\\fields\\\\MultiSelect':\n        case 'ttempleton\\\\categorygroupsfield\\\\fields\\\\CategoryGroupsField':\n          {\n            const values = []\n            const $selected = $input.find('select').children(':selected')\n\n            $selected.each(function () {\n              values.push($(this).text())\n            })\n\n            value = _escapeHTML(_limit(values.join(', ')))\n          }\n          break\n        case 'craft\\\\fields\\\\Number':\n        case 'craft\\\\fields\\\\PlainText':\n          value = _escapeHTML(_limit($input.children('input[type=\"text\"]').val()))\n          break\n        case 'craft\\\\fields\\\\RadioButtons':\n          {\n            const $checked = $input.find('input[type=\"radio\"]:checked')\n            const label = $checked.closest('label').text()\n\n            value = _escapeHTML(_limit(label))\n          }\n          break\n        case 'craft\\\\redactor\\\\Field':\n          value = _escapeHTML(_limit(Craft.getText($input.find('textarea').val())))\n          break\n        case 'craft\\\\ckeditor\\\\Field':\n          value = _escapeHTML(_limit(Craft.getText($input.find('[role=\"textbox\"]').html())))\n          break\n        case 'craft\\\\fields\\\\Url':\n          value = _escapeHTML(_limit($input.children('input[type=\"url\"]').val()))\n          break\n        case 'craft\\\\fields\\\\Matrix':\n        case 'verbb\\\\supertable\\\\fields\\\\SuperTableField':\n          {\n            const $subFields = $field.find('.field')\n            const $subInputs = $subFields.find('input[type!=\"hidden\"], select, textarea, .label')\n\n            const values = []\n\n            $subInputs.each(function () {\n              const $subInput = $(this)\n              let subValue = null\n\n              if ($subInput.is('input, textarea')) {\n                subValue = Craft.getText(Garnish.getInputPostVal($subInput))\n              } else if ($subInput.is('select')) {\n                subValue = $subInput.find('option:selected').text()\n              } else if ($subInput.hasClass('label')) {\n                // TODO check for lightswitch maybe?\n                subValue = $subInput.text()\n              }\n\n              if (subValue) {\n                values.push(_limit(subValue))\n              }\n            })\n\n            value = _escapeHTML(values.join(', '))\n          }\n          break\n        case 'typedlinkfield\\\\fields\\\\LinkField':\n        case 'fruitstudios\\\\linkit\\\\fields\\\\LinkitField':\n          {\n            const values = []\n            const $selectedType = $input.find('select').children(':selected').first()\n            const $visibleOption = $input.find('.linkfield--typeOption:not(.hidden), [class^=\"linkit--\"]:not(.hidden)')\n            const visibleInputVal = $visibleOption.find('input[type!=\"hidden\"]').val()\n            const $visibleElement = $visibleOption.find('.element')\n            const customText = $input.find('.field[id*=\"customText\"] input, .linkit--customText input').val()\n\n            values.push(_limit($selectedType.text()))\n\n            if (visibleInputVal) {\n              values.push(_limit(visibleInputVal))\n            }\n\n            if ($visibleElement.length > 0) {\n              const title = $visibleElement.find('.title, .label').eq(0).text()\n\n              values.push(_limit(title))\n            }\n\n            if (customText) {\n              values.push(_limit(customText))\n            }\n\n            value = _escapeHTML(values.join(', '))\n          }\n          break\n        case 'luwes\\\\codemirror\\\\fields\\\\CodeMirrorField':\n        {\n          const lines = []\n\n          $field.find('.CodeMirror-line > span').each(function () {\n            lines.push($(this).text())\n          })\n\n          value = _escapeHTML(lines.join(' '))\n          break\n        }\n        case 'rias\\\\positionfieldtype\\\\fields\\\\Position':\n        {\n          const $selected = $input.find('.btn.active')\n\n          value = _escapeHTML($selected.prop('title'))\n          break\n        }\n        case 'wrav\\\\oembed\\\\fields\\\\OembedField':\n          value = _escapeHTML(_limit($input.children('input').val()))\n      }\n\n      if (value && previewText.length < 10) {\n        previewText.push('<span class=\"preview_section\">', value, '</span>')\n      }\n    })\n\n    this.$previewContainer.html(previewText.join(''))\n  },\n\n  isNew () {\n    return /^new/.test(this.getId())\n  },\n\n  isSelected () {\n    return this.$container.hasClass('is-selected')\n  },\n\n  collapse (save, animate) {\n    this.toggleExpansion(false, save, animate)\n  },\n\n  expand (save, animate) {\n    this.toggleExpansion(true, save, animate)\n  },\n\n  toggleExpansion (expand, save, animate) {\n    expand = typeof expand === 'boolean' ? expand : !this._expanded\n    save = typeof save === 'boolean' ? save : true\n    animate = !Garnish.prefersReducedMotion() && (typeof animate === 'boolean' ? animate : true)\n\n    if (expand !== this._expanded) {\n      this._expanded = expand\n\n      const expandContainer = this.$menuContainer.find('[data-action=\"expand\"]').parent()\n      const collapseContainer = this.$menuContainer.find('[data-action=\"collapse\"]').parent()\n\n      this.$container\n        .toggleClass('is-expanded', this._expanded)\n        .toggleClass('is-collapsed', !this._expanded)\n\n      expandContainer.toggleClass('hidden', this._expanded)\n      collapseContainer.toggleClass('hidden', !this._expanded)\n\n      if (!this._expanded) {\n        this.updatePreview()\n      }\n\n      const contentHeight = this.$contentContainer.outerHeight() | 0\n      const childrenHeight = this.$childrenContainer.outerHeight() | 0\n\n      const expandedCss = {\n        opacity: 1,\n        height: contentHeight + childrenHeight\n      }\n      const collapsedCss = {\n        opacity: 0,\n        height: 0\n      }\n      const clearCss = {\n        opacity: '',\n        height: ''\n      }\n\n      if (animate) {\n        this.$bodyContainer\n          .css(this._expanded ? collapsedCss : expandedCss)\n          .velocity(this._expanded ? expandedCss : collapsedCss, 'fast', e => {\n            if (this._expanded) {\n              this.$bodyContainer.css(clearCss)\n            }\n          })\n      } else {\n        this.$bodyContainer.css(this._expanded ? clearCss : collapsedCss)\n      }\n\n      if (save) {\n        this.saveExpansion()\n      }\n\n      this.trigger('toggleExpansion', {\n        expanded: this._expanded\n      })\n    }\n  },\n\n  isExpanded () {\n    return this._expanded\n  },\n\n  saveExpansion () {\n    if (!this.isNew()) {\n      // Use the duplicated block ID if we're on a new provisional draft\n      // The server-side code will also apply the new state to the canonical block\n      const thisBlockId = this.getId()\n      const elementEditor = this.$form.data('elementEditor')\n      const duplicatedBlockId = elementEditor?.duplicatedElements[thisBlockId] ?? thisBlockId\n      const sentBlockId = elementEditor?.settings.isProvisionalDraft ? duplicatedBlockId : thisBlockId\n      const data = {\n        expanded: this.isExpanded() ? 1 : 0,\n        blockId: sentBlockId,\n        siteId: this.getSiteId()\n      }\n\n      Craft.queue.push(() => new Promise((resolve, reject) => {\n        Craft.sendActionRequest('POST', 'neo/input/save-expansion', { data }).then(resolve).catch(reject)\n      }))\n    }\n  },\n\n  disable () {\n    this.toggleEnabled(false)\n  },\n\n  enable () {\n    this.toggleEnabled(true)\n  },\n\n  toggleEnabled (enable = !this._enabled) {\n    if (enable !== this._enabled) {\n      this._enabled = enable\n\n      const enableContainer = this.$menuContainer.find('[data-action=\"enable\"]').parent()\n      const disableContainer = this.$menuContainer.find('[data-action=\"disable\"]').parent()\n\n      this.$container\n        .toggleClass('is-enabled', this._enabled)\n        .toggleClass('is-disabled', !this._enabled)\n\n      this.$status.toggleClass('hidden', this._enabled)\n\n      enableContainer.toggleClass('hidden', this._enabled)\n      disableContainer.toggleClass('hidden', !this._enabled)\n\n      this.$enabledInput.val(this._enabled ? '1' : '')\n\n      this.trigger('toggleEnabled', {\n        enabled: this._enabled\n      })\n    }\n  },\n\n  isEnabled () {\n    return this._enabled\n  },\n\n  toggleShowButtons (show = !this._showButtons) {\n    this.$buttonsContainer.toggleClass('hidden', !show)\n    this.$childrenWarningsContainer.toggleClass('hidden', show)\n  },\n\n  selectTab (tabName) {\n    this.$tabButton.removeClass('is-selected')\n    this.$tabContainer.addClass('hidden')\n    const $tabButton = this.$tabButton.filter(`[data-neo-b-info=\"${tabName}\"]`).addClass('is-selected')\n    const $tabContainer = this.$tabContainer.eq($tabButton.index()).removeClass('hidden')\n    this.$tabsButton.text(tabName)\n    Craft.ElementThumbLoader.retryAll()\n\n    this.trigger('selectTab', { tabName, $tabButton, $tabContainer })\n  },\n\n  updateResponsiveness () {\n    const isMobileBrowser = Garnish.isMobileBrowser()\n    this._topbarLeftWidth ??= this.$topbarLeftContainer.width() -\n      (this._expanded ? 0 : this.$previewContainer.width()) -\n      (isMobileBrowser ? this.$handleContainer.width() : 0)\n    this._topbarRightWidth ??= this.$topbarRightContainer.width()\n    const hasRoomForIndividualTabs = this.$topbarContainer.width() < this._topbarLeftWidth + this._topbarRightWidth\n\n    this.$handleContainer.toggleClass('hidden', isMobileBrowser)\n    this.$tabsContainer.toggleClass('invisible', hasRoomForIndividualTabs)\n    this.$tabsButton.toggleClass('invisible', !hasRoomForIndividualTabs)\n  },\n\n  updateActionsMenu () {\n    const blocks = this._field.getBlocks()\n    const parentBlockType = this.getParent()?.getBlockType()\n    let allowedBlockTypes = parentBlockType?.getChildBlocks() ?? this._field.getBlockTypes(true)\n\n    if (allowedBlockTypes === true || allowedBlockTypes === '*') {\n      allowedBlockTypes = this._field.getBlockTypes(false)\n    } else if (Array.isArray(allowedBlockTypes)) {\n      allowedBlockTypes = allowedBlockTypes.map(bt => typeof bt === 'string' ? this._field.getBlockTypeByHandle(bt) : bt)\n    }\n\n    this.updateMenuStates(\n      this._field.getName(),\n      blocks,\n      this._field.getMaxBlocks(),\n      true,\n      allowedBlockTypes,\n      this._level === 1 ? this._field.getMaxTopBlocks() : 0\n    )\n  },\n\n  // Deprecated in 3.0.4; use `updateActionsMenu()` instead\n  updateMenuStates (field, blocks = [], maxBlocks = 0, additionalCheck = null, allowedBlockTypes = false, maxTopBlocks = 0) {\n    additionalCheck = typeof additionalCheck === 'boolean' ? additionalCheck : true\n\n    const blockType = this.getBlockType()\n    const blocksOfType = blocks.filter(b => b.getBlockType().getHandle() === blockType.getHandle())\n    const maxBlockTypes = blockType.getMaxBlocks()\n    const siblingBlocks = this.getSiblings(blocks)\n\n    const totalTopBlocks = blocks.filter(block => block.isTopLevel()).length\n\n    const maxBlocksMet = maxBlocks > 0 && blocks.length >= maxBlocks\n    const maxTopBlocksMet = maxTopBlocks > 0 && totalTopBlocks >= maxTopBlocks\n\n    const allDisabled = maxBlocksMet || maxTopBlocksMet || !additionalCheck\n    const typeDisabled = maxBlockTypes > 0 && blocksOfType.length >= maxBlockTypes\n    let cloneDisabled = allDisabled || typeDisabled\n\n    const pasteData = JSON.parse(window.localStorage.getItem('neo:copy') || '{}')\n    let pasteDisabled = allDisabled || !pasteData.blocks || !pasteData.field || pasteData.field !== field\n\n    // Test to see if pasting would exceed the parent's max child blocks\n    const parentBlock = this.getParent(blocks)\n    if (!pasteDisabled && parentBlock) {\n      const maxChildBlocks = parentBlock.getBlockType().getMaxChildBlocks()\n\n      if (maxChildBlocks > 0) {\n        const childBlockCount = parentBlock.getChildren(blocks).length\n        const pasteBlockCount = pasteData.blocks.length\n        pasteDisabled ||= childBlockCount + pasteBlockCount > maxChildBlocks\n      }\n    }\n\n    // Test to see if pasting would exceed this block's max sibling blocks\n    if (!(pasteDisabled && cloneDisabled)) {\n      const maxSiblingBlocks = this.getBlockType().getMaxSiblingBlocks()\n\n      if (maxSiblingBlocks > 0) {\n        const hasSameBlockType = block => {\n          if (Object.prototype.hasOwnProperty.call(block, 'type')) {\n            return block.type === this.getBlockType().getId()\n          } else if (typeof block.getBlockType === 'function') {\n            return block.getBlockType().getHandle() === this.getBlockType().getHandle()\n          }\n\n          return false\n        }\n\n        const siblingBlockCount = siblingBlocks.filter(hasSameBlockType, this).length\n        const pasteSiblingBlockCount = pasteData.blocks ? pasteData.blocks.filter(hasSameBlockType, this).length : 0\n        pasteDisabled ||= siblingBlockCount + pasteSiblingBlockCount > maxSiblingBlocks\n        cloneDisabled ||= siblingBlockCount >= maxSiblingBlocks\n      }\n    }\n\n    if (!pasteDisabled) {\n      const currentBlockTypesById = blocks.reduce((m, b) => {\n        const bt = b.getBlockType()\n        const id = bt.getId()\n        const v = m[id] || { blockType: bt, count: 0 }\n\n        v.count++\n        m[id] = v\n\n        return m\n      })\n\n      for (const pasteBlock of pasteData.blocks) {\n        const pasteBlockTypeObj = currentBlockTypesById[pasteBlock.type]\n\n        // Test to see if any max block types properties will be violated\n        if (pasteBlockTypeObj) {\n          const pasteBlockType = pasteBlockTypeObj.blockType\n          const currentBlocksOfTypeCount = pasteBlockTypeObj.count\n          const maxPasteBlockTypes = pasteBlockType.getMaxBlocks()\n          const pasteTypeDisabled = maxPasteBlockTypes > 0 && currentBlocksOfTypeCount >= maxPasteBlockTypes\n\n          pasteDisabled ||= pasteTypeDisabled\n        }\n\n        // Test to see if the top level paste blocks have a block type that is allowed to be pasted here\n        if (pasteBlock.level === 1) {\n          pasteDisabled ||= !allowedBlockTypes.find(bt => bt.getId() === pasteBlock.type)\n        }\n      }\n    }\n\n    const siblingIndex = siblingBlocks.indexOf(this)\n    const disableMoveUp = siblingIndex <= 0\n    const disableMoveDown = [-1, siblingBlocks.length - 1].includes(siblingIndex)\n\n    this.$menuContainer.find('[data-action=\"moveUp\"]').parent().toggleClass('hidden', disableMoveUp)\n    this.$menuContainer.find('[data-action=\"moveDown\"]').parent().toggleClass('hidden', disableMoveDown)\n    this.$menuContainer.find('[data-action=\"add\"]').toggleClass('disabled', allDisabled)\n    this.$menuContainer.find('[data-action=\"duplicate\"]').toggleClass('disabled', cloneDisabled)\n    this.$menuContainer.find('[data-action=\"paste\"]').toggleClass('disabled', pasteDisabled)\n  },\n\n  _handleActionClick (e) {\n    e.preventDefault()\n    this['@settingSelect'](e)\n  },\n\n  _handleActionKeydown (e) {\n    if (e.keyCode === Garnish.SPACE_KEY) {\n      e.preventDefault()\n      this['@settingSelect'](e)\n    }\n  },\n\n  _handleTabKeydown (e) {\n    if (e.keyCode === Garnish.SPACE_KEY) {\n      this['@setTab'](e)\n    }\n  },\n\n  _detectChange () {\n    // When editing a draft and autosave is enabled, we need to force modified to be set, or\n    // returning the block to its original values will cause it not to be resaved.\n    const elementEditor = this.$form.data('elementEditor')\n\n    if (elementEditor?.enableAutosave && elementEditor.settings.draftId) {\n      this.setModified(true)\n      this._forceModified = true\n    }\n\n    if (!this._forceModified) {\n      const initial = this._initialState\n      const content = Garnish.getPostData(this.$contentContainer)\n\n      const modified = !Craft.compare(content, initial.content, false) ||\n        initial.enabled !== this._enabled ||\n        initial.level !== this._level\n\n      if (modified !== this._modified) {\n        this.setModified(modified)\n      }\n    }\n\n    this.trigger('change')\n  },\n\n  '@settingSelect' (e) {\n    this._settingsMenu.hide()\n    const $option = $(e.target)\n\n    if (!$option.hasClass('disabled')) {\n      switch ($option.attr('data-action')) {\n        case 'collapse':\n          this.collapse()\n          break\n        case 'expand':\n          this.expand()\n          break\n        case 'disable':\n          this.disable()\n          this.collapse()\n          break\n        case 'enable':\n          this.enable()\n          this.expand()\n          break\n        case 'moveUp':\n          this.trigger('moveUpBlock', { block: this })\n          break\n        case 'moveDown':\n          this.trigger('moveDownBlock', { block: this })\n          break\n        case 'delete':\n          this.trigger('removeBlock', { block: this })\n          break\n        case 'add':\n          this.trigger('addBlockAbove', { block: this })\n          break\n        case 'copy':\n          this.trigger('copyBlock', { block: this })\n          break\n        case 'paste':\n          this.trigger('pasteBlock', { block: this })\n          break\n        case 'duplicate':\n          this.trigger('duplicateBlock', { block: this })\n          break\n      }\n    }\n  },\n\n  '@doubleClickTitle' (e) {\n    e.preventDefault()\n\n    const $target = $(e.target)\n    const $checkFrom = $target.parent()\n    const isLeft = $checkFrom.closest(this.$topbarLeftContainer).length > 0\n    const isRight = $checkFrom.closest(this.$topbarRightContainer).length > 0\n\n    if (!isLeft && !isRight) {\n      this.$form.data('elementEditor')?.pause()\n      this.toggleExpansion()\n      this.$form.data('elementEditor')?.resume()\n    }\n  },\n\n  '@setTab' (e) {\n    e.preventDefault()\n    this._tabsMenu.hide()\n\n    const $tab = $(e.currentTarget)\n    const tabName = $tab.attr('data-neo-b-info')\n\n    this.selectTab(tabName)\n  }\n},\n{\n  _totalNewBlocks: 0,\n\n  getNewId () {\n    return `new${this._totalNewBlocks++}`\n  }\n})\n","import Craft from 'craft'\n\nexport function addFieldLinks ($element) {\n  if (Craft.CpFieldInspectPlugin) {\n    Craft.CpFieldInspectPlugin.addFieldLinks()\n  }\n}\n","import $ from 'jquery'\nimport Craft from 'craft'\nimport Garnish from 'garnish'\n\nconst _defaults = {\n  blockTypes: [],\n  groups: [],\n  items: null,\n  maxBlocks: 0,\n  maxTopBlocks: 0,\n  blocks: null\n}\n\nexport default Garnish.Base.extend({\n\n  _blockTypes: [],\n  _groups: [],\n  _maxBlocks: 0,\n  _maxTopBlocks: 0,\n\n  init (settings = {}) {\n    settings = Object.assign({}, _defaults, settings)\n\n    if (settings.items) {\n      this._items = Array.from(settings.items)\n      this._blockTypes = this._items.filter(i => i.getType() === 'blockType')\n      this._groups = this._items.filter(i => i.getType() === 'group')\n    } else {\n      this._blockTypes = Array.from(settings.blockTypes)\n      this._groups = Array.from(settings.groups)\n      this._items = [...this._blockTypes, ...this._groups].sort((a, b) => a.getSortOrder() - b.getSortOrder())\n    }\n\n    this._maxBlocks = settings.maxBlocks | 0\n    this._maxTopBlocks = settings.maxTopBlocks | 0\n\n    this.$container = this._generateButtons()\n\n    const $neo = this.$container.find('[data-neo-bn]')\n    this.$buttonsContainer = $neo.filter('[data-neo-bn=\"container.buttons\"]')\n    this.$menuContainer = $neo.filter('[data-neo-bn=\"container.menu\"]')\n    this.$blockButtons = $neo.filter('[data-neo-bn=\"button.addBlock\"]')\n    this.$groupButtons = $neo.filter('[data-neo-bn=\"button.group\"]')\n\n    if (settings.blocks) {\n      this.updateButtonStates(settings.blocks)\n    }\n\n    this.addListener(this.$blockButtons, 'activate', '@newBlock')\n  },\n\n  _generateButtons () {\n    const buttonsHtml = []\n    let blockTypesHtml = []\n    let currentGroup = null\n    let firstButton = true\n\n    const generateGroupDropdown = () => {\n      buttonsHtml.push(`\n          <div class=\"btn dashed${firstButton ? ' add icon' : ''} menubtn\" data-neo-bn=\"button.group\">\n            ${currentGroup.getName()}\n          </div>\n          <div class=\"menu\">\n            <ul>${blockTypesHtml.join('')}\n            </ul>\n          </div>`)\n      firstButton = false\n      blockTypesHtml = []\n    }\n\n    buttonsHtml.push(`\n      <div class=\"ni_buttons\">\n        <div class=\"btngroup\" data-neo-bn=\"container.buttons\">`)\n\n    for (let i = 0; i < this._items.length; i++) {\n      const item = this._items[i]\n      const type = item.getType()\n\n      if (type === 'blockType') {\n        const titleAttr = item.getDescription() ? ` title=\"${item.getDescription()}\"` : ''\n\n        if (currentGroup !== null) {\n          blockTypesHtml.push(`\n            <li>\n              <a${titleAttr} aria-label=\"${item.getName()}\" data-neo-bn=\"button.addBlock\" data-neo-bn-info=\"${item.getHandle()}\">${item.getName()}</a>\n            </li>`)\n        } else {\n          buttonsHtml.push(`\n          <button${titleAttr} aria-label=\"${item.getName()}\" class=\"btn dashed${firstButton ? ' add icon' : ''}\" data-neo-bn=\"button.addBlock\" data-neo-bn-info=\"${item.getHandle()}\">\n            ${item.getName()}\n          </button>`)\n          firstButton = false\n        }\n      } else if (type === 'group') {\n        if (currentGroup !== null && blockTypesHtml.length > 0) {\n          generateGroupDropdown()\n        }\n\n        if (item.isBlank()) {\n          // Never show dropdowns for groups with blank names, as they're just used to end the previous group\n          currentGroup = null\n        } else if (!item.getAlwaysShowDropdown() && ((i + 2) >= this._items.length || this._items[i + 2].getType() === 'group')) {\n          // Don't show dropdowns if we're not forcing them to show, and there's only one block type in this group\n          currentGroup = null\n        } else {\n          currentGroup = item\n        }\n      }\n    }\n\n    if (currentGroup !== null && blockTypesHtml.length > 0) {\n      generateGroupDropdown()\n    }\n\n    buttonsHtml.push(`\n        </div>\n        <div class=\"btn dashed add icon menubtn hidden\" data-neo-bn=\"container.menu\">\n          ${Craft.t('neo', 'Add a block')}\n        </div>`)\n\n    // Menu, for views where the buttons would exceed the editor width\n    currentGroup = null\n    let lastGroupHadBlockTypes = false\n    buttonsHtml.push(`\n        <div class=\"menu\">\n          <ul>`)\n\n    for (const item of this._items) {\n      const type = item.getType()\n\n      if (type === 'blockType') {\n        if (currentGroup !== null && !lastGroupHadBlockTypes) {\n          lastGroupHadBlockTypes = true\n\n          buttonsHtml.push(`\n              <h6>${currentGroup.getName()}</h6>\n              <ul class=\"padded\">`)\n        }\n\n        const titleAttr = item.getDescription() ? ` title=\"${item.getDescription()}\"` : ''\n        buttonsHtml.push(`\n            <li>\n              <a${titleAttr} aria-label=\"${item.getName()}\" data-neo-bn=\"button.addBlock\" data-neo-bn-info=\"${item.getHandle()}\">\n                ${item.getName()}\n              </a>\n            </li>`)\n      } else if (type === 'group') {\n        if (currentGroup === null || lastGroupHadBlockTypes) {\n          buttonsHtml.push(`\n              </ul>`)\n        }\n\n        lastGroupHadBlockTypes = false\n        currentGroup = item.isBlank() ? null : item\n\n        if (currentGroup === null) {\n          buttonsHtml.push(`\n              <ul>`)\n        }\n      }\n    }\n\n    buttonsHtml.push(`\n          </ul>\n        </div>\n      </div>`)\n\n    return $(buttonsHtml.join(''))\n  },\n\n  initUi () {\n    $('.menubtn', this.$container).menubtn()\n    this.updateResponsiveness()\n  },\n\n  getBlockTypes () {\n    return Array.from(this._blockTypes)\n  },\n\n  getGroups () {\n    return Array.from(this._groups)\n  },\n\n  getMaxBlocks () {\n    return this._maxBlocks\n  },\n\n  updateButtonStates (blocks = [], additionalCheck = null, block = null) {\n    additionalCheck = typeof additionalCheck === 'boolean' ? additionalCheck : true\n\n    const that = this\n\n    const totalTopBlocks = blocks.filter(block => block.isTopLevel()).length\n    const maxBlocksMet = this._maxBlocks > 0 && blocks.length >= this._maxBlocks\n    const maxTopBlocksMet = this._maxTopBlocks > 0 && totalTopBlocks >= this._maxTopBlocks\n\n    const allDisabled = maxBlocksMet || maxTopBlocksMet || !additionalCheck\n\n    this.$blockButtons.each(function () {\n      const $button = $(this)\n      let disabled = allDisabled\n\n      if (!disabled) {\n        const blockHasSameType = b => b.getBlockType().getHandle() === blockType.getHandle()\n        const blockType = that.getBlockTypeByButton($button)\n        const blocksOfType = blocks.filter(blockHasSameType)\n        const maxBlocksOfType = blockType.getMaxBlocks()\n\n        const maxSiblingBlocks = blockType.getMaxSiblingBlocks()\n        const siblingBlocksOfType = block !== null\n          ? block.getChildren(blocks).filter(blockHasSameType)\n          // This is at the top level\n          : blocks.filter(b => b.isTopLevel() && b.getBlockType().getHandle() === blockType.getHandle())\n\n        disabled ||= (maxBlocksOfType > 0 && blocksOfType.length >= maxBlocksOfType) ||\n          (maxSiblingBlocks > 0 && siblingBlocksOfType.length >= maxSiblingBlocks)\n      }\n\n      $button.toggleClass('disabled', disabled)\n    })\n\n    this.$groupButtons.each(function () {\n      const $button = $(this)\n      const menu = $button.data('menubtn')\n      let disabled = allDisabled\n\n      if (!disabled && menu) {\n        const $menuButtons = menu.menu.$options\n        disabled = $menuButtons.length === $menuButtons.filter('.disabled').length\n      }\n\n      $button.toggleClass('disabled', disabled)\n    })\n  },\n\n  updateResponsiveness () {\n    this._buttonsContainerWidth ||= this.$buttonsContainer.width()\n    const isMobile = this.$container.width() < this._buttonsContainerWidth\n\n    this.$buttonsContainer.toggleClass('hidden', isMobile)\n    this.$menuContainer.toggleClass('hidden', !isMobile)\n  },\n\n  getBlockTypeByButton ($button) {\n    const btHandle = $button.attr('data-neo-bn-info')\n\n    return this._blockTypes.find(bt => bt.getHandle() === btHandle)\n  },\n\n  '@newBlock' (e) {\n    const $button = $(e.currentTarget)\n    const blockTypeHandle = $button.attr('data-neo-bn-info')\n    const blockType = this._blockTypes.find(bt => bt.getHandle() === blockTypeHandle)\n\n    this.trigger('newBlock', {\n      blockType\n    })\n  }\n})\n","import $ from 'jquery'\nimport Garnish from 'garnish'\nimport Craft from 'craft'\n\nimport NS from '../namespace'\n\nimport BlockSort from './BlockSort'\nimport BlockType from './BlockType'\nimport Group from './Group'\nimport Block from './Block'\nimport Buttons from './Buttons'\n\nimport './styles/input.scss'\n\nconst _defaults = {\n  name: null,\n  namespace: [],\n  blockTypes: [],\n  groups: [],\n  blocks: [],\n  inputId: null,\n  maxBlocks: 0,\n  maxTopBlocks: 0,\n  maxLevels: 0\n}\n\nexport default Garnish.Base.extend({\n\n  _templateNs: [],\n  _name: null,\n  _siteId: null,\n\n  init (settings = {}) {\n    settings = Object.assign({}, _defaults, settings)\n\n    this._templateNs = NS.parse(settings.namespace)\n    this._blockTypes = []\n    this._groups = settings.groups.map(gInfo => new Group(gInfo))\n    this._blocks = []\n    this._name = settings.name\n    this._maxBlocks = settings.maxBlocks\n    this._maxTopBlocks = settings.maxTopBlocks\n    this._maxLevels = settings.maxLevels\n    this._ownerId = null\n    this._showBlockTypeHandles = settings.showBlockTypeHandles\n\n    const ownerIdElement = $('[name=\"setId\"], [name=\"entryId\"], [name=\"categoryId\"]')\n    if (ownerIdElement.length) {\n      this._ownerId = ownerIdElement.val()\n    }\n\n    this.$container = $('#' + settings.inputId)\n\n    const setGroupIds = {}\n    this._groups.forEach(group => {\n      setGroupIds[group.getId()] = true\n    })\n\n    const tempBlockTypes = {}\n\n    for (const btInfo of settings.blockTypes) {\n      // Filter out the block type if its group isn't included\n      if (btInfo.groupId === null || typeof setGroupIds[btInfo.groupId] !== 'undefined') {\n        const blockType = new BlockType(btInfo)\n        this._blockTypes.push(blockType)\n        tempBlockTypes[blockType.getHandle()] = blockType\n      }\n    }\n\n    this.$form = this.$container.closest('form')\n    this._siteId = this.$form.find('input[name=\"siteId\"]').val()\n\n    const $neo = this.$container.find('[data-neo]')\n    this.$blocksContainer = $neo.filter('[data-neo=\"container.blocks\"]')\n    this.$buttonsContainer = $neo.filter('[data-neo=\"container.buttons\"]')\n\n    this._buttons = new Buttons({\n      blockTypes: this.getBlockTypes(true),\n      groups: this.getGroups(),\n      maxBlocks: this.getMaxBlocks(),\n      maxTopBlocks: this.getMaxTopBlocks()\n    })\n\n    this.$buttonsContainer.append(this._buttons.$container)\n    this._buttons.on('newBlock', e => this['@newBlock'](e))\n    this._buttons.initUi()\n\n    this._blockSort = new BlockSort({\n      container: this.$blocksContainer,\n      handle: '[data-neo-b$=\".button.move\"]',\n      maxTopBlocks: this.getMaxTopBlocks(),\n      filter: () => {\n        // Only return all the selected items if the target item is selected\n        if (this._blockSort.$targetItem.hasClass('is-selected')) {\n          return this._blockSelect.getSelectedItems()\n        }\n\n        return this._blockSort.$targetItem\n      },\n      collapseDraggees: true,\n      magnetStrength: 4,\n      helperLagBase: 1.5,\n      helperOpacity: 0.9,\n      onDragStop: () => {\n        this._updateBlockOrder()\n        this._updateButtons()\n      }\n    })\n\n    this._blockSelect = new Garnish.Select(this.$blocksContainer, null, {\n      multi: true,\n      vertical: true,\n      handle: '> .ni_block_topbar [data-neo-b$=\".select\"]',\n      checkboxMode: true,\n      selectedClass: 'is-selected sel'\n    })\n\n    this.$blocksContainer.find('.ni_block').each((i, blockDiv) => {\n      const $block = $(blockDiv)\n      const bInfo = {}\n      bInfo.id = $block.attr('data-neo-b-id')\n      bInfo.sortOrder = i\n      bInfo.collapsed = $block.hasClass('is-collapsed')\n      bInfo.enabled = !!$block.find(`[data-neo-b=\"${bInfo.id}.input.enabled\"]`).val()\n      bInfo.level = parseInt($block.find(`[data-neo-b=\"${bInfo.id}.input.level\"]`).val())\n      bInfo.field = this\n      bInfo.namespace = [...this._templateNs, bInfo.id]\n\n      const blockTypeHandle = $block.find(`[data-neo-b=\"${bInfo.id}.input.type\"]`).val()\n      const blockType = tempBlockTypes[blockTypeHandle]\n\n      // If the block type data isn't there, it's been filtered out and the blocks shouldn't be included\n      if (typeof blockType === 'undefined') {\n        $block.remove()\n        return\n      }\n\n      bInfo.blockType = new BlockType({\n        id: blockType.getId(),\n        fieldLayoutId: blockType.getFieldLayoutId(),\n        name: blockType.getName(),\n        handle: blockType.getHandle(),\n        description: blockType.getDescription(),\n        maxBlocks: blockType.getMaxBlocks(),\n        maxSiblingBlocks: blockType.getMaxSiblingBlocks(),\n        maxChildBlocks: blockType.getMaxChildBlocks(),\n        childBlocks: blockType.getChildBlocks(),\n        topLevel: blockType.getTopLevel(),\n        hasChildBlocksUiElement: blockType.hasChildBlocksUiElement()\n      })\n      bInfo.buttons = new Buttons({\n        items: blockType.getChildBlockItems(this.getItems()),\n        maxBlocks: this.getMaxBlocks()\n      })\n      bInfo.showButtons = !this.atMaxLevels(bInfo.level)\n\n      const block = new Block(bInfo)\n      block.initUi(false)\n      this._setBlockEvents(block)\n\n      this._blocks.push(block)\n      this._blockSort.addBlock(block)\n      this._blockSelect.addItems(block.$container)\n    })\n\n    this._updateBlockOrder()\n    this._updateBlockChildren()\n    this._updateButtons()\n\n    // Make sure menu states (for pasting blocks) are updated when changing browser tabs\n    this.addListener(document, 'visibilitychange.input', () => this._updateButtons())\n\n    this.addListener(this.$container, 'resize', () => this.updateResponsiveness())\n\n    const serialized = typeof this.$form.data('serializer') === 'function'\n      ? this.$form.data('serializer')()\n      : this.$form.serialize()\n    this.$form.data('initialSerializedValue', serialized)\n\n    // Add error highlight for Matrix fields within Neo\n    this._setMatrixClassErrors()\n    this._setBlockTypeClassErrors()\n\n    this._blocks\n      .filter(block => !block.isExpanded())\n      .forEach(block => block.updatePreview())\n\n    this.trigger('afterInit')\n  },\n\n  getName () {\n    return this._name\n  },\n\n  updateResponsiveness () {\n    for (const block of this._blocks) {\n      block.updateResponsiveness()\n      block.getButtons()?.updateResponsiveness()\n    }\n\n    this._buttons.updateResponsiveness()\n    this._tempButtons?.updateResponsiveness()\n  },\n\n  addBlock (block, index = -1, level = 1, animate = null) {\n    const blockCount = this._blocks.length\n    index = index >= 0 ? Math.max(0, Math.min(index, blockCount)) : blockCount\n    animate = !Garnish.prefersReducedMotion() && (typeof animate === 'boolean' ? animate : true)\n\n    const prevBlock = index > 0 ? this._blocks[index - 1] : false\n    const nextBlock = index < blockCount ? this._blocks[index] : false\n\n    if (!prevBlock) {\n      this.$blocksContainer.prepend(block.$container)\n    } else {\n      const minLevel = nextBlock ? nextBlock.getLevel() : 1\n      const maxLevel = prevBlock.getLevel() + (prevBlock.getBlockType().isParent() ? 1 : 0)\n\n      level = Math.max(minLevel, Math.min(level, maxLevel))\n\n      const prevBlockOnLevel = this._findPrevBlockOnLevel(index, level)\n\n      if (prevBlockOnLevel) {\n        prevBlockOnLevel.$container.after(block.$container)\n      } else {\n        prevBlock.$blocksContainer.prepend(block.$container)\n      }\n    }\n\n    block.setLevel(level)\n\n    this._blocks.push(block)\n    this._blockSort.addBlock(block)\n    this._blockSelect.addItems(block.$container)\n\n    block.initUi()\n    this._setBlockEvents(block)\n    this._destroyTempButtons()\n    this._updateBlockOrder()\n    this._updateBlockChildren()\n    this._updateButtons()\n\n    if (animate) {\n      block.$container\n        .css({\n          opacity: 0,\n          marginBottom: -(block.$container.outerHeight())\n        })\n        .velocity({\n          opacity: 1,\n          marginBottom: 10\n        }, 'fast', e => Garnish.requestAnimationFrame(() => Garnish.scrollContainerToElement(block.$container)))\n    }\n\n    this.trigger('addBlock', {\n      block,\n      index\n    })\n  },\n\n  removeBlock (block, animate = null, _delayAnimate = null) {\n    this.$form.data('elementEditor')?.pause()\n\n    animate = !Garnish.prefersReducedMotion() && (typeof animate === 'boolean' ? animate : true)\n    _delayAnimate = typeof _delayAnimate === 'boolean' ? _delayAnimate : false\n\n    const childBlocks = this._findChildBlocks(this._blocks.indexOf(block))\n    for (const childBlock of childBlocks) {\n      this.removeBlock(childBlock, true, true)\n    }\n\n    block.off('.input')\n\n    this._blocks = this._blocks.filter(b => b !== block)\n    this._blockSort.removeItems(block.$container)\n    this._blockSelect.removeItems(block.$container)\n\n    this._destroyTempButtons()\n    this._updateButtons()\n\n    const finishTheRemoval = () => {\n      block.$container.remove()\n      this._updateBlockChildren()\n      this.$form.data('elementEditor')?.resume()\n    }\n\n    if (animate) {\n      block.$container\n        .css({\n          opacity: 1,\n          marginBottom: 10\n        })\n        .velocity({\n          opacity: 0,\n          marginBottom: _delayAnimate ? 10 : -(block.$container.outerHeight())\n        }, 'fast', _ => finishTheRemoval())\n    } else {\n      finishTheRemoval()\n    }\n\n    block.destroy()\n\n    this.trigger('removeBlock', {\n      block\n    })\n  },\n\n  _setBlockEvents (block) {\n    block.on('removeBlock.input', _ => {\n      if (this.getSelectedBlocks().length > 1) {\n        if (window.confirm(Craft.t('neo', 'Are you sure you want to delete the selected blocks?'))) {\n          this._blockBatch(block, b => this.removeBlock(b))\n        }\n      } else {\n        this.removeBlock(block)\n      }\n    })\n    block.on('toggleEnabled.input', e => this._blockBatch(block, b => b.toggleEnabled(e.enabled)))\n    block.on('toggleExpansion.input', e => this._blockBatch(block, b => b.toggleExpansion(e.expanded)))\n    block.on('moveUpBlock.input', _ => this._moveBlock(block, 'up'))\n    block.on('moveDownBlock.input', _ => this._moveBlock(block, 'down'))\n    block.on('newBlock.input', e => this['@newBlock'](Object.assign(e, { index: this._getNextBlockIndex(block) })))\n    block.on('addBlockAbove.input', e => this['@addBlockAbove'](e))\n    block.on('copyBlock.input', e => this['@copyBlock'](e))\n    block.on('pasteBlock.input', e => this['@pasteBlock'](e))\n    block.on('duplicateBlock.input', e => this['@duplicateBlock'](e))\n    block.on('change.input', () => this.trigger('change', { block }))\n  },\n\n  _moveBlock (block, direction, animate = true) {\n    if (!['up', 'down'].includes(direction)) {\n      return\n    }\n\n    this.$form.data('elementEditor')?.pause()\n\n    const siblings = block.getSiblings(this.getBlocks())\n    const index = siblings.indexOf(block)\n    const moveUp = index > 0 && direction === 'up'\n    const moveDown = index < siblings.length - 1 && direction === 'down'\n\n    if (index === -1 || moveUp === moveDown) {\n      return\n    }\n\n    const animateMove = !Garnish.prefersReducedMotion() && (typeof animate === 'boolean' ? animate : true)\n    const $block = block.$container\n\n    const startTheMove = () => {\n      $block.detach()\n\n      if (moveUp) {\n        siblings[index - 1].$container.before($block)\n      } else {\n        siblings[index + 1].$container.after($block)\n      }\n    }\n\n    const finishTheMove = () => {\n      this._updateBlockOrder()\n      this._updateButtons()\n      this.$form.data('elementEditor')?.resume()\n    }\n\n    if (animateMove) {\n      $block\n        .css({\n          opacity: 1,\n          marginBottom: 10\n        })\n        .velocity({\n          opacity: 0,\n          marginBottom: -($block.outerHeight())\n        }, 'fast', _ => {\n          startTheMove()\n\n          $block\n            .css({\n              opacity: 0,\n              marginBottom: -($block.outerHeight())\n            })\n            .velocity({\n              opacity: 1,\n              marginBottom: 10\n            }, 'fast', _ => {\n              finishTheMove()\n              Garnish.requestAnimationFrame(() => Garnish.scrollContainerToElement($block))\n            })\n        })\n    } else {\n      startTheMove()\n      finishTheMove()\n    }\n  },\n\n  getBlockByElement ($block) {\n    return this._blocks.find(block => block.$container.is($block))\n  },\n\n  getBlocks (level = 0) {\n    return level > 0 ? this._blocks.filter(b => b.getLevel() === level) : Array.from(this._blocks)\n  },\n\n  getBlockTypeById (id) {\n    return this._blockTypes.find(bt => bt.getId() === id)\n  },\n\n  getBlockTypeByHandle (handle) {\n    return this._blockTypes.find(bt => bt.getHandle() === handle)\n  },\n\n  getBlockTypes (topLevelOnly) {\n    topLevelOnly = typeof topLevelOnly === 'boolean' ? topLevelOnly : false\n\n    return topLevelOnly\n      ? this._blockTypes.filter(bt => bt.getTopLevel())\n      : Array.from(this._blockTypes)\n  },\n\n  getGroups () {\n    return Array.from(this._groups)\n  },\n\n  getItems () {\n    return [...this.getBlockTypes(), ...this.getGroups()].sort((a, b) => a.getSortOrder() - b.getSortOrder())\n  },\n\n  getMaxBlocks () {\n    return this._maxBlocks\n  },\n\n  getMaxTopBlocks () {\n    return this._maxTopBlocks\n  },\n\n  getMaxLevels () {\n    return this._maxLevels\n  },\n\n  atMaxLevels (level) {\n    return this._maxLevels > 0 && level + 1 > this._maxLevels\n  },\n\n  getSelectedBlocks () {\n    const $selectedBlocks = this._blockSelect.getSelectedItems()\n    return this._blocks.filter(block => block.$container.closest($selectedBlocks).length > 0)\n  },\n\n  _setMatrixClassErrors () {\n    // TODO: will need probably need to find a method within php instead of JS\n    // temp solution for now.\n    const matrixErrors = $('.ni_block_body .matrix-field .input.errors')\n\n    matrixErrors.each(function () {\n      const _this = $(this)\n      const tabContainer = _this.closest('.ni_block_content_tab')\n      const tabData = tabContainer.data('neo-b-info')\n      const closestContainer = _this.closest('.ni_block')\n      const bar = closestContainer.find('.tabs .tab[data-neo-b-info=\"' + tabData + '\"]')\n\n      if (bar.length) {\n        bar.addClass('has-errors')\n      }\n    })\n  },\n\n  _setBlockTypeClassErrors () {\n    const tabErrors = $('.ni_block .tab.has-errors')\n\n    tabErrors.each(function () {\n      const parents = tabErrors.parents('.ni_block.is-collapsed')\n\n      parents.each(function () {\n        const _this = $(this)\n        _this.find('> .ni_block_topbar .title .blocktype').addClass('has-errors')\n      })\n    })\n  },\n\n  _updateBlockOrder () {\n    const blocks = []\n\n    this.$blocksContainer.find('.ni_block').each((index, element) => {\n      const block = this.getBlockByElement(element)\n      blocks.push(block)\n    })\n\n    this._blocks = blocks\n    this.trigger('updateBlockOrder')\n    this.trigger('change', { block: null })\n  },\n\n  _updateBlockChildren () {\n    for (const block of this._blocks) {\n      const children = block.$blocksContainer.children('.ni_block')\n      const collapsedCount = Math.min(children.length, 8) // Any more than 8 and it's a little too big\n      const collapsedChildren = []\n\n      for (let i = 0; i < collapsedCount; i++) {\n        collapsedChildren.push('<div class=\"ni_block_collapsed-children_child\"></div>')\n      }\n\n      block.$collapsedChildrenContainer.html(collapsedChildren.join(''))\n    }\n  },\n\n  _checkMaxChildren (block) {\n    if (!block) {\n      return true\n    }\n\n    const blockType = block.getBlockType()\n    const maxChildren = blockType.getMaxChildBlocks()\n\n    if (maxChildren > 0) {\n      const children = this._findChildBlocks(block)\n\n      return children.length < maxChildren\n    }\n\n    return true\n  },\n\n  _updateButtons () {\n    const blocks = this.getBlocks()\n    this._buttons.updateButtonStates(blocks)\n    this._tempButtons?.updateButtonStates(blocks, this._checkMaxChildren(this._tempButtonsBlock))\n\n    for (const block of blocks) {\n      block.updateActionsMenu()\n      block.getButtons()?.updateButtonStates(blocks, this._checkMaxChildren(block), block)\n      block.toggleShowButtons(!this.atMaxLevels(block.getLevel()))\n    }\n  },\n\n  _blockBatch (block, callback) {\n    const blocks = block.isSelected() ? this.getSelectedBlocks() : [block]\n\n    for (const b of blocks) {\n      callback(b)\n    }\n  },\n\n  _destroyTempButtons (animate = null) {\n    animate = !Garnish.prefersReducedMotion() && (typeof animate === 'boolean' ? animate : true)\n\n    if (this._tempButtons) {\n      const buttons = this._tempButtons\n      buttons.off('newBlock')\n\n      if (animate) {\n        buttons.$container\n          .css({\n            opacity: 1,\n            marginBottom: 10\n          })\n          .velocity({\n            opacity: 0,\n            marginBottom: -(buttons.$container.outerHeight())\n          }, 'fast', e => buttons.$container.remove())\n      } else {\n        buttons.$container.remove()\n      }\n\n      this._tempButtons = null\n      this._tempButtonsBlock = null\n    }\n  },\n\n  _findPrevBlockOnLevel (index, level) {\n    if (index instanceof Block) {\n      index = this._blocks.indexOf(index)\n    }\n\n    const blocks = this._blocks\n\n    let block = blocks[--index]\n    let lowestLevel = Number.MAX_VALUE\n\n    while (block) {\n      const blockLevel = block.getLevel()\n\n      if (blockLevel < lowestLevel) {\n        if (blockLevel === level) {\n          return block\n        }\n\n        lowestLevel = blockLevel\n      }\n\n      block = this._blocks[--index]\n    }\n\n    return false\n  },\n\n  _findChildBlocks (index, descendants = null) {\n    if (index instanceof Block) {\n      index = this._blocks.indexOf(index)\n    }\n\n    descendants = (typeof descendants === 'boolean' ? descendants : false)\n    const block = this._blocks[index]\n\n    return block ? block.getChildren(this._blocks, descendants) : []\n  },\n\n  _findParentBlock (index) {\n    if (index instanceof Block) {\n      index = this._blocks.indexOf(index)\n    }\n\n    const blocks = this._blocks\n    const block = blocks[index]\n\n    if (block) {\n      const level = block.getLevel()\n\n      if (level > 1) {\n        let i = index\n        let currentBlock = block\n\n        while (currentBlock && currentBlock.getLevel() >= level) {\n          currentBlock = blocks[--i]\n        }\n\n        return currentBlock\n      }\n    }\n\n    return null\n  },\n\n  _getNextBlockIndex (index) {\n    if (index instanceof Block) {\n      index = this._blocks.indexOf(index)\n    }\n\n    const descendants = this._findChildBlocks(index, true)\n    const lastDescendant = descendants[descendants.length - 1]\n\n    return (lastDescendant ? this._blocks.indexOf(lastDescendant) : index) + 1\n  },\n\n  _duplicate (data, block) {\n    this.$form.data('elementEditor')?.pause()\n\n    const animate = !Garnish.prefersReducedMotion()\n    const $spinner = $(`<div class=\"ni_spinner\">${animate ? '<div class=\"spinner\"></div>' : 'Loading block'}</div>`)\n\n    block.$container.after($spinner)\n\n    let spinnerComplete = false\n    let spinnerCallback = function () {}\n\n    if (animate) {\n      $spinner\n        .css({\n          opacity: 0,\n          marginBottom: -($spinner.outerHeight())\n        })\n        .velocity({\n          opacity: 1,\n          marginBottom: 10\n        }, 'fast', () => {\n          spinnerComplete = true\n          spinnerCallback()\n        })\n    } else {\n      spinnerComplete = true\n      spinnerCallback()\n    }\n\n    Craft.postActionRequest('neo/input/render-blocks', data, e => {\n      if (e.success && e.blocks.length > 0) {\n        const newBlocks = []\n\n        for (const renderedBlock of e.blocks) {\n          const newId = Block.getNewId()\n\n          const blockType = this.getBlockTypeById(renderedBlock.type)\n          const newBlockType = new BlockType({\n            id: blockType.getId(),\n            fieldLayoutId: blockType.getFieldLayoutId(),\n            name: blockType.getName(),\n            handle: blockType.getHandle(),\n            maxBlocks: blockType.getMaxBlocks(),\n            maxSiblingBlocks: blockType.getMaxSiblingBlocks(),\n            maxChildBlocks: blockType.getMaxChildBlocks(),\n            childBlocks: blockType.getChildBlocks(),\n            topLevel: blockType.getTopLevel(),\n            hasChildBlocksUiElement: blockType.hasChildBlocksUiElement(),\n            tabs: renderedBlock.tabs\n          })\n\n          const newButtons = new Buttons({\n            items: newBlockType.getChildBlockItems(this.getItems()),\n            maxBlocks: this.getMaxBlocks()\n          })\n\n          const newBlock = new Block({\n            namespace: [...this._templateNs, newId],\n            field: this,\n            blockType: newBlockType,\n            id: newId,\n            level: renderedBlock.level | 0,\n            buttons: newButtons,\n            enabled: !!renderedBlock.enabled,\n            collapsed: !!renderedBlock.collapsed,\n            showButtons: !this.atMaxLevels(renderedBlock.level | 0),\n            showBlockTypeHandle: this._showBlockTypeHandles\n          }, true)\n\n          newBlocks.push(newBlock)\n        }\n\n        spinnerCallback = () => {\n          let newIndex = this._getNextBlockIndex(block)\n\n          for (const newBlock of newBlocks) {\n            this.addBlock(newBlock, newIndex++, newBlock.getLevel(), false)\n          }\n\n          if (animate) {\n            const firstBlock = newBlocks[0]\n\n            firstBlock.$container\n              .css({\n                opacity: 0,\n                marginBottom: $spinner.outerHeight() - firstBlock.$container.outerHeight() + 10\n              })\n              .velocity({\n                opacity: 1,\n                marginBottom: 10\n              }, 'fast', _ => Garnish.requestAnimationFrame(() => Garnish.scrollContainerToElement(firstBlock.$container)))\n          }\n\n          $spinner.remove()\n          this.$form.data('elementEditor')?.resume()\n        }\n\n        if (spinnerComplete) {\n          spinnerCallback()\n        }\n      }\n    })\n  },\n\n  '@newBlock' (e) {\n    const blockId = Block.getNewId()\n    const block = new Block({\n      namespace: [...this._templateNs, blockId],\n      field: this,\n      blockType: e.blockType,\n      id: blockId,\n      buttons: new Buttons({\n        items: e.blockType.getChildBlockItems(this.getItems()),\n        maxBlocks: this.getMaxBlocks()\n      }),\n      showButtons: !this.atMaxLevels(e.level),\n      showBlockTypeHandle: this._showBlockTypeHandles\n    }, true)\n\n    this.addBlock(block, e.index, e.level)\n  },\n\n  '@addBlockAbove' (e) {\n    this._destroyTempButtons()\n\n    const animate = !Garnish.prefersReducedMotion() && e.animate !== false\n    const block = e.block\n    const index = this._blocks.indexOf(block)\n    const parent = this._findParentBlock(index)\n    const blocks = this.getBlocks()\n    const buttons = new Buttons({\n      blockTypes: !parent ? this.getBlockTypes(true) : [],\n      blocks,\n      groups: !parent ? this.getGroups() : [],\n      items: parent ? parent.getBlockType().getChildBlockItems(this.getItems()) : null,\n      maxBlocks: this.getMaxBlocks()\n    })\n\n    block.$container.before(buttons.$container)\n\n    buttons.on('newBlock', e => this['@newBlock']({\n      blockType: e.blockType,\n      index,\n      level: block.getLevel()\n    }))\n\n    buttons.initUi()\n\n    if (animate) {\n      buttons.$container\n        .css({\n          opacity: 0,\n          marginBottom: -(buttons.$container.outerHeight())\n        })\n        .velocity({\n          opacity: 1,\n          marginBottom: 10\n        }, 'fast', _ => Garnish.requestAnimationFrame(() => Garnish.scrollContainerToElement(buttons.$container)))\n    }\n\n    this._tempButtons = buttons\n    this._tempButtonsBlock = this._findParentBlock(block)\n\n    this._tempButtons.updateButtonStates(blocks, this._checkMaxChildren(this._tempButtonsBlock), this._tempButtonsBlock)\n  },\n\n  '@copyBlock' (e) {\n    // Get the selected blocks and their descendants\n    const blockGroups = []\n    let blockCount = 0\n    const ownerId = this._ownerId\n\n    this._blockBatch(e.block, (block) => {\n      // To prevent block descendants from being copied multiple times, determine whether the current block has\n      // been added to the most recently added group.\n      const blockAdded = blockCount > 0 && blockGroups[blockGroups.length - 1].indexOf(block) !== -1\n\n      if (!blockAdded) {\n        const newGroup = []\n        newGroup.push(block, ...this._findChildBlocks(block, true))\n        blockGroups.push(newGroup)\n        blockCount += newGroup.length\n      }\n    })\n\n    // Collect the relevant data from those blocks to be stored for pasting\n    const data = {\n      field: this._name,\n      blocks: []\n    }\n\n    for (const group of blockGroups) {\n      const firstBlockLevel = group[0].getLevel() - 1\n\n      for (const block of group) {\n        const blockData = {\n          type: block.getBlockType().getId(),\n          level: block.getLevel() - firstBlockLevel,\n          content: block.getContent(),\n          ownerId\n        }\n\n        if (block.isEnabled()) {\n          blockData.enabled = 1\n        }\n\n        if (!block.isExpanded()) {\n          blockData.collapsed = 1\n        }\n\n        data.blocks.push(blockData)\n      }\n    }\n\n    window.localStorage.setItem('neo:copy', JSON.stringify(data))\n\n    this._updateButtons()\n\n    const notice = blockCount === 1 ? '1 block copied' : '{n} blocks copied'\n    Craft.cp.displayNotice(Craft.t('neo', notice, { n: blockCount }))\n  },\n\n  '@pasteBlock' (e) {\n    const block = e.block\n    const baseLevel = block.getLevel() - 1\n    const copyData = window.localStorage.getItem('neo:copy')\n\n    if (copyData) {\n      const { blocks } = JSON.parse(copyData)\n\n      for (const pasteBlock of blocks) {\n        pasteBlock.level += baseLevel\n      }\n\n      NS.enter(this._templateNs)\n\n      const data = {\n        namespace: NS.toFieldName(),\n        siteId: this._siteId,\n        blocks\n      }\n\n      NS.leave()\n\n      this._duplicate(data, block)\n    }\n  },\n\n  '@duplicateBlock' (e) {\n    const block = e.block\n    const blockIndex = this._blocks.indexOf(block)\n    const subBlocks = this._findChildBlocks(blockIndex, true)\n    const ownerId = this._ownerId\n\n    const getBlockData = block => {\n      return {\n        collapsed: !block.isExpanded() | 0,\n        content: block.getContent(),\n        enabled: block.isEnabled() | 0,\n        level: block.getLevel(),\n        ownerId,\n        type: block.getBlockType().getId()\n      }\n    }\n\n    NS.enter(this._templateNs)\n\n    const data = {\n      namespace: NS.toFieldName(),\n      siteId: this._siteId,\n      blocks: [\n        getBlockData(block),\n        ...subBlocks.map(getBlockData)\n      ]\n    }\n\n    NS.leave()\n\n    this._duplicate(data, block)\n  }\n})\n","import Input from './input/Input'\n\nconst context = window ?? this\nconst inputs = []\n\ncontext.Neo = {\n  Input,\n  inputs,\n\n  createInput (settings = {}) {\n    const input = new Input(settings)\n    inputs.push(input)\n\n    return input\n  }\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","jQuery","Garnish","Craft","_stack","enter","segments","join","this","fromFieldName","joined","getNamespace","push","enterByFieldName","fieldName","leave","length","pop","Array","from","parse","value","indexOf","split","separator","prefix","toFieldName","replace","toString","slice","match","BlockSort","$container","blocks","maxTopBlocks","_draggeeBlocks","init","items","settings","$","defaults","axis","base","container","getHelperTargetX","$draggee","offset","left","getHelperTargetY","magnet","magnetStrength","draggeeOffsetY","top","mouseY","mouseOffsetY","getBlockByElement","$block","find","block","is","getParentBlock","$parentBlock","parent","closest","onDragStart","that","each","_calculateMidpoints","onDrag","midpoint","_getClosestMidpoint","_moveDraggeeToBlock","type","direction","onDragStop","setLevel","parentBlock","getLevel","$childBlock","childBlock","returnHelpersToDraggees","addBlock","addItems","removeBlock","filter","b","removeItems","minDistance","Number","MAX_VALUE","maxDistance","MIN_VALUE","_currentMidpoints","DIRECTION_UP","position","_draggeeBlockHeight","_draggeeBlockY","height","midpoints","_getBlockMidpoints","keys","DIRECTION_DOWN","endMidpoint","margin","TYPE_END","isExpanded","blockHeight","topbarHeight","$topbarContainer","childrenHeight","$childrenContainer","preChildrenContentHeight","$contentContainer","_validateDraggeeChildren","TYPE_CONTENT","buttonsHeight","getButtons","TYPE_CHILDREN","validChild","$blocksContainer","append","after","before","getBlockType","isParent","prepend","_updateHelperAppearance","field","getField","maxLevels","getMaxLevels","parentLevel","firstDraggeeLevel","blockExceedsMax","blockOrDescendantExceedsMax","descendants","getChildren","getBlocks","some","topBlocks","children","topBlocksCount","draggeeBlock","getTopLevel","includes","blockType","maxChildBlocks","getMaxChildBlocks","blockChildren","blockChildCount","blockChildrenWithoutDraggees","checkedDraggeeBlocks","isValidChildBlock","draggeeBlockType","maxSiblingBlocks","getMaxSiblingBlocks","draggeeBlocksOfType","getHandle","$helper","helpers","id","data","css","width","_defaults","name","errors","assign","_name","_errors","getErrors","getName","fieldLayoutId","sortOrder","handle","maxBlocks","childBlocks","topLevel","tabs","hasChildBlocksUiElement","_id","_fieldLayoutId","_sortOrder","_handle","_description","description","_minBlocks","minBlocks","_maxBlocks","_minSiblingBlocks","_maxSiblingBlocks","_minChildBlocks","minChildBlocks","_maxChildBlocks","_childBlocks","_topLevel","_tabs","tabNames","map","tab","Tab","_html","html","_js","js","_hasChildBlocksUiElement","getType","getId","getFieldLayoutId","getSortOrder","getDescription","getMinBlocks","getMaxBlocks","getMinSiblingBlocks","getMinChildBlocks","getChildBlocks","getTabs","getHtml","blockId","_replaceBlockIdPlaceholder","getJs","input","getChildBlockItems","firstPass","item","hasChildBlock","i","nextItem","cb","isArray","alwaysShowDropdown","_alwaysShowDropdown","getAlwaysShowDropdown","isBlank","index","$parent","eq","namespace","level","buttons","enabled","collapsed","modified","showButtons","showBlockTypeHandle","_resources","_escapeMap","_resourceFilter","url","href","src","paramIndex","substr","isNew","_escapeHTML","str","s","_limit","l","_templateNs","_field","_blockType","_initialised","_expanded","_enabled","_modified","_initialState","_forceModified","generateElement","NS","_buttons","_initialEnabled","_showButtons","_renderOldChildBlocksContainer","_generateElement","$neo","$bodyContainer","$childrenWarningsContainer","$collapsedChildrenContainer","$buttonsContainer","$topbarLeftContainer","$topbarRightContainer","$handleContainer","$tabsContainer","$tabContainer","$menuContainer","$previewContainer","$tabButton","$settingsButton","$togglerButton","$tabsButton","$enabledInput","$levelInput","$status","$sortOrder","$form","on","e","trigger","hasErrors","selector","addClass","toggleExpansion","toggleShowButtons","addListener","showHandle","baseInputName","baseInputId","typeTabs","hasTabs","actionBtnLabel","actionMenuId","tabsBtnLabel","tabsMenuId","sortOrderName","elementHtml","_collapsed","_level","tabName","$elementHtml","class","insertAfter","initUi","callInitUiElements","$foot","_tabsMenu","removeClass","add","_handleTabKeydown","_settingsMenu","_handleActionClick","_handleActionKeydown","toggleEnabled","updateResponsiveness","content","detectChange","_detectChange","observer","window","MutationObserver","setTimeout","observe","attributes","childList","characterData","subtree","_detectChangeObserver","setModified","fieldInputName","destroy","remove","clearInterval","_detectChangeInterval","disconnect","isTopLevel","val","toggleClass","isModified","getSiteId","_siteId","$siteId","getContent","rawContent","setValue","currentSet","rawName","getParent","blockParent","currentBlock","currentLevel","getSiblings","updatePreview","condensed","$childFields","$fields","previewText","$field","$input","fieldType","label","text","values","$assets","$asset","$thumbContainer","srcset","title","checked","color","colorText","colorRev","background","date","time","$subInputs","$subInput","subValue","hasClass","$selectedType","first","$visibleOption","visibleInputVal","$visibleElement","customText","lines","test","isSelected","collapse","save","animate","expand","expandContainer","collapseContainer","expandedCss","opacity","outerHeight","collapsedCss","clearCss","velocity","saveExpansion","expanded","thisBlockId","elementEditor","duplicatedBlockId","duplicatedElements","sentBlockId","isProvisionalDraft","siteId","Promise","resolve","reject","then","catch","disable","enable","enableContainer","disableContainer","isEnabled","show","selectTab","isMobileBrowser","_topbarLeftWidth","_topbarRightWidth","hasRoomForIndividualTabs","updateActionsMenu","parentBlockType","allowedBlockTypes","getBlockTypes","bt","getBlockTypeByHandle","updateMenuStates","getMaxTopBlocks","additionalCheck","blocksOfType","maxBlockTypes","siblingBlocks","totalTopBlocks","allDisabled","typeDisabled","cloneDisabled","pasteData","JSON","localStorage","getItem","pasteDisabled","childBlockCount","pasteBlockCount","hasSameBlockType","siblingBlockCount","pasteSiblingBlockCount","currentBlockTypesById","reduce","m","v","count","pasteBlock","pasteBlockTypeObj","pasteBlockType","currentBlocksOfTypeCount","maxPasteBlockTypes","pasteTypeDisabled","siblingIndex","disableMoveUp","disableMoveDown","preventDefault","keyCode","enableAutosave","draftId","initial","hide","$option","target","attr","$checkFrom","isLeft","isRight","pause","resume","currentTarget","_totalNewBlocks","getNewId","blockTypes","groups","_blockTypes","_groups","_maxTopBlocks","_items","sort","_generateButtons","$blockButtons","$groupButtons","updateButtonStates","buttonsHtml","blockTypesHtml","currentGroup","firstButton","generateGroupDropdown","titleAttr","lastGroupHadBlockTypes","menubtn","getGroups","maxBlocksMet","maxTopBlocksMet","$button","disabled","blockHasSameType","getBlockTypeByButton","maxBlocksOfType","siblingBlocksOfType","menu","$menuButtons","$options","_buttonsContainerWidth","isMobile","btHandle","blockTypeHandle","inputId","gInfo","Group","_blocks","_maxLevels","_ownerId","_showBlockTypeHandles","showBlockTypeHandles","ownerIdElement","setGroupIds","forEach","group","tempBlockTypes","btInfo","groupId","BlockType","Buttons","_blockSort","$targetItem","_blockSelect","getSelectedItems","collapseDraggees","helperLagBase","helperOpacity","_updateBlockOrder","_updateButtons","multi","vertical","checkboxMode","selectedClass","blockDiv","bInfo","parseInt","getItems","atMaxLevels","Block","_setBlockEvents","_updateBlockChildren","document","serialized","serialize","_setMatrixClassErrors","_setBlockTypeClassErrors","_tempButtons","blockCount","Math","max","min","prevBlock","nextBlock","minLevel","maxLevel","prevBlockOnLevel","_findPrevBlockOnLevel","_destroyTempButtons","marginBottom","_delayAnimate","_findChildBlocks","off","finishTheRemoval","_","getSelectedBlocks","confirm","_blockBatch","_moveBlock","_getNextBlockIndex","siblings","moveUp","moveDown","animateMove","startTheMove","detach","finishTheMove","getBlockTypeById","topLevelOnly","$selectedBlocks","_this","tabData","bar","tabErrors","parents","element","collapsedCount","collapsedChildren","_checkMaxChildren","maxChildren","_tempButtonsBlock","callback","lowestLevel","blockLevel","_findParentBlock","lastDescendant","_duplicate","$spinner","spinnerComplete","spinnerCallback","success","newBlocks","renderedBlock","newId","newBlockType","newButtons","newBlock","newIndex","firstBlock","blockGroups","ownerId","newGroup","firstBlockLevel","blockData","setItem","stringify","notice","n","baseLevel","copyData","blockIndex","subBlocks","getBlockData","context","inputs","Neo","Input","createInput"],"sourceRoot":""}